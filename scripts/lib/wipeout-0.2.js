(function(){var g={};var d=function(k,h,j){j=j||window;if(k==null){return}if(k instanceof Array||k instanceof HTMLCollection||k instanceof NodeList){for(var l=0,m=k.length;l<m;l++){h.call(j,k[l],l)}}else{for(var l in k){h.call(j,k[l],l)}}};var e=function(k,h,j){j=j||window;if(k==null){return}if(k instanceof Array){for(var l=k.length-1;l>=0;l--){h.call(j,k[l],l)}}else{var m=[];for(var l in k){m.push(l)}for(var l=m.length-1;l>=0;l--){h.call(j,k[m[l]],m[l])}}};var a=function(j,i,h){var k=b("wpfko.bindings."+j,h);ko.bindingHandlers[j]={init:k.init,update:k.update};if(i){ko.virtualElements.allowedBindings[j]=true}};var b=function(i,h){i=i.split(".");var j=i.splice(0,i.length-1);var k={};k[i[i.length-1]]=h();f(j.join("."),k);return k[i[i.length-1]]};var f=function(j,i){j=j.split(".");if(j[0]!=="wpfko"){throw'Root must be "wpfko".'}j.splice(0,1);var h=g;d(j,function(k){h=h[k]||(h[k]={})});if(i&&i instanceof Function){i=i()}d(i,function(l,k){h[k]=l})};b("wpfko.utils.obj",function(){var i=function(k,l){if(!l){l=window}var j=k.split(".");for(var m=0,n=j.length;m<n;m++){l=l[j[m]];if(!l){throw'Cannot create object "'+k+'"'}}if(l instanceof Function){return new l()}else{throw k+" is not a valid function."}};var h=function(l){var m=[];for(var j=0,k=l.length;j<k;j++){m.push(l[j])}return m};return{enumerate:d,enumerateDesc:e,createObject:i,copyArray:h}});b("wpfko.util.obj",function(){return g.utils.obj});b("wpfko.base.object",function(){var i=function(){};var h={parents:[],children:[]};i.clearVirtualCache=function(j){if(!j){h.parents.length=0;h.children.length=0;return}for(var k=0,l=h.children.length;k<l;k++){if(h.children[k]===j||h.parents[k]===j){h.children.splice(k,1);h.parents.splice(k,1)}}};i.useVirtualCache=true;i.prototype._super=function(){var k=null;if(i.useVirtualCache){var r=h.children.indexOf(arguments.callee.caller);if(r!==-1){k=h.parents[r]}}if(!k){var o=[];var l=this.constructor.prototype;while(l){o.push(l);l=Object.getPrototypeOf(l)}o.reverse();for(var m=0,n=o.length;m<n;m++){for(var q in o[m]){if(o[m][q]===arguments.callee.caller){for(var p=m-1;p>=0;p--){if(o[p][q]!==arguments.callee.caller){k=o[p][q];if(i.useVirtualCache){h.children.push(arguments.callee.caller);h.parents.push(k)}break}}break}}}if(!k){throw"Could not find method in parent class"}}return k.apply(this,arguments)};i.extend=function(j){for(var k in this){if(this.hasOwnProperty(k)&&this[k]&&this[k].constructor===Function){j[k]=this[k]}}function l(){this.constructor=j}l.prototype=this.prototype;j.prototype=new l();return j};return i});b("wpfko.base.visual",function(){var h=g.base.object.extend(function(i){this._super();this.templateItems={};this.renderedChildren=[];this._rootHtmlElement=null;this._routedEventSubscriptions=[];this.templateId=ko.observable(i||h.getDefaultTemplateId())});h.prototype.unRender=function(){d(this.templateItems,function(l,j){if(l instanceof h){l.dispose()}delete this.templateItems[j];var k=this.renderedChildren.indexOf(l);if(k!==-1){this.renderedChildren.splice(k,1)}},this);d(this.renderedChildren.splice(0,this.renderedChildren.length),function(i){if(i instanceof h){i.dispose()}});ko.utils.domData.set(this._rootHtmlElement,g.bindings.wpfko.utils.wpfkoKey,undefined);ko.virtualElements.emptyNode(this._rootHtmlElement);delete this._rootHtmlElement};h.prototype.dispose=function(){this.unRender();for(var j in this){if(ko.isObservable(this[j])&&this[j].dispose instanceof Function){this[j].dispose()}}d(this._routedEventSubscriptions.splice(0,this._routedEventSubscriptions.length),function(i){i.dispose()})};h.getParentElement=function(k){var j=0;var i=k.previousSibling;while(i){if(g.utils.ko.virtualElements.isVirtualClosing(i)){j--}if(g.utils.ko.virtualElements.isVirtual(i)){if(j===0){return i}j++}i=i.previousSibling}return k.parentElement};h.prototype.getParents=function(){var i=this;var j=[];while(i){j.push(i);i=i.getParent()}return j};h.prototype.getParent=function(){var j;var i=h.getParentElement(this._rootHtmlElement);while(i){if(j=ko.utils.domData.get(i,g.bindings.wpfko.utils.wpfkoKey)){return j}i=h.getParentElement(i)}};h.prototype.unRegisterRoutedEvent=function(n,j,k){for(var l=0,m=this._routedEventSubscriptions.length;l<m;l++){if(this._routedEventSubscriptions[l].routedEvent===n){this._routedEventSubscriptions[l].event.unRegister(j,context);return}}};h.prototype.registerRoutedEvent=function(o,j,k){var n;for(var l=0,m=this._routedEventSubscriptions.length;l<m;l++){if(this._routedEventSubscriptions[l].routedEvent===o){n=this._routedEventSubscriptions[l];break}}if(!n){n=new g.base.routedEventRegistration(o);this._routedEventSubscriptions.push(n)}n.event.register(j,k)};h.prototype.triggerRoutedEvent=function(n,j){if(!(j instanceof g.base.routedEventArgs)){j=new g.base.routedEventArgs(j,this)}for(var k=0,l=this._routedEventSubscriptions.length;k<l;k++){if(j.handled){return}if(this._routedEventSubscriptions[k].routedEvent===n){this._routedEventSubscriptions[k].event.trigger(j)}}if(!j.handled){var m=this.getParent();if(m){m.triggerRoutedEvent(n,j)}}};h.prototype.rootHtmlChanged=function(j,i){};h.prototype.applicationInitialized=function(){};h.getDefaultTemplateId=(function(){var i=null;return function(){if(!i){i=g.base.contentControl.createAnonymousTemplate("<span>No template has been specified</span>")}return i}})();h.getBlankTemplateId=(function(){var i=null;return function(){if(!i){i=g.base.contentControl.createAnonymousTemplate("")}return i}})();h.visualGraph=function(k,i){if(!k){return[]}i=i||function(){return typeof arguments[0]};var j=[];g.utils.obj.enumerate(g.utils.html.getAllChildren(k),function(m){g.utils.obj.enumerate(h.visualGraph(m),j.push,j)});var l=ko.utils.domData.get(k,g.bindings.wpfko.utils.wpfkoKey);if(l){return[{viewModel:l,display:i(l),children:j}]}return j};h.reservedTags=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","head","header","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","map","mark","menu","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"];return h});b("wpfko.base.view",function(){var j=g.base.visual.extend(function(l,k){this._super(l);this.model=ko.observable(k||null);var k=null;this.model.subscribe(function(m){try{this.modelChanged(k,m)}finally{k=m}},this);this._bindings={}});var h=function(o,k,l){for(var m=0,n=o.length;m<n;m++){k.call(l,o[m],m)}};var i=function(k,l,m){if(ko.isObservable(k[l])){k[l](ko.utils.unwrapObservable(m))}else{k[l]=ko.utils.unwrapObservable(m)}};j.prototype.onInitialized=function(){};j.prototype.dispose=function(){this._super();for(var k in this._bindings){this._bindings[k].dispose()}};j.prototype.bind=function(k,p,o){if(o&&(!ko.isObservable(this[k])||!ko.isObservable(p()))){throw"Two way bindings must be between 2 observables"}if(this._bindings[k]){this._bindings[k].dispose();delete this._bindings[k]}var n=ko.dependentObservable({read:function(){return ko.utils.unwrapObservable(p())},write:o?function(){var q=p();if(q){q(arguments[0])}}:undefined});i(this,k,n.peek());var l=n.subscribe(function(q){i(this,k,q)},this);var m=o?this[k].subscribe(function(q){i({x:n},"x",q)},this):null;this._bindings[k]={dispose:function(){if(l){l.dispose();l=null}if(m){m.dispose();m=null}if(n){n.dispose();n=null}}}};j.elementHasModelBinding=function(k){for(var l=0,m=k.attributes.length;l<m;l++){if(k.attributes[l].nodeName==="model"||k.attributes[l].nodeName==="model-tw"){return true}}for(var l=0,m=k.childNodes.length;l<m;l++){if(k.childNodes[l].nodeType===1&&k.childNodes[l].nodeName==="model"){return true}}return false};j.reservedPropertyNames=["constructor","constructor-tw","id","id-tw"];j.prototype.initialize=function(l,k){if(this._initialized){throw"Cannot call initialize item twice"}this._initialized=true;if(!l){return}if(!j.elementHasModelBinding(l)&&g.utils.ko.peek(this.model)==null){this.bind("model",k.$parent.model)}h(l.attributes,function(m){if(j.reservedPropertyNames.indexOf(m.nodeName)!==-1){return}var n=m.nodeName,o="";if(n.indexOf("-tw")===m.nodeName.length-3){n=n.substr(0,n.length-3);o=",\n\t\t\tfunction(val) {\n\t\t\t\tif(!ko.isObservable("+m.value+"))\n\t\t\t\t\tthrow 'Two way bindings must be between 2 observables';\n\t\t\t\t"+m.value+"(val);\n\t\t\t}"}g.template.engine.createJavaScriptEvaluatorFunction("(function() {\n\t\t\t$data.bind('"+n+"', function() {\n\t\t\t\treturn "+m.value+";\n\t\t\t}"+o+");\n\n\t\t\treturn '';\n\t\t})()")(k)});h(l.childNodes,function(m,n){if(m.nodeType!==1||j.reservedPropertyNames.indexOf(m.nodeName)!==-1){return}var s="string";for(var p=0,q=m.attributes.length;p<q;p++){if(m.attributes[p].nodeName==="constructor"&&m.attributes[p].nodeValue){s=m.attributes[p].nodeValue;break}}if(j.objectParser[s.replace(/^\s+|\s+$/g,"").toLowerCase()]){var o=[];var r=r||new XMLSerializer();for(var p=0,q=m.childNodes.length;p<q;p++){o.push(r.serializeToString(m.childNodes[p]))}var t=j.objectParser[s.replace(/^\s+|\s+$/g,"").toLowerCase()](o.join(""));if(ko.isObservable(this[m.nodeName])){this[m.nodeName](t)}else{this[m.nodeName]=t}}else{var t=g.utils.obj.createObject(s);t.initialize(m,k.createChildContext(t));if(ko.isObservable(this[m.nodeName])){this[m.nodeName](t)}else{this[m.nodeName]=t}}},this)};j.objectParser={json:function(k){return JSON.parse(k)},string:function(k){return k},bool:function(l){var k=l.replace(/^\s+|\s+$/g,"").toLowerCase();return k?k!=="false"&&k!=="0":false},"int":function(k){return parseInt(k.replace(/^\s+|\s+$/g,""))},"float":function(k){return parseFloat(k.replace(/^\s+|\s+$/g,""))},regexp:function(k){return new RegExp(k.replace(/^\s+|\s+$/g,""))},date:function(k){return new Date(k.replace(/^\s+|\s+$/g,""))}};j.prototype.modelChanged=function(l,k){};return j});b("wpfko.base.contentControl",function(){var h=g.base.view.extend(function(j){this._super(j||g.base.visual.getBlankTemplateId());this.template=h.createTemplatePropertyFor(this.templateId,this)});h.createTemplatePropertyFor=function(k,j){return ko.dependentObservable({read:function(){var l=document.getElementById(k());return l?l.textContent:""},write:function(l){k(g.base.contentControl.createAnonymousTemplate(l))},owner:j})};var i="data-templatehash";h.createAnonymousTemplate=(function(){var k=null;var j=Math.floor(Math.random()*1000000000);return function(q,l){if(!k){k=g.utils.html.createElement("<div style='display: none'></div>");document.body.appendChild(k)}q=q.replace(/^\s+|\s+$/g,"");var m=h.hashCode(q).toString();if(!l){for(var o=0,p=k.childNodes.length;o<p;o++){if(k.childNodes[o].nodeType===1&&k.childNodes[o].nodeName==="SCRIPT"&&k.childNodes[o].id&&k.childNodes[o].attributes[i]&&k.childNodes[o].attributes[i].nodeValue===m&&k.childNodes[o].innerHTML===q){return k.childNodes[o].id}}}var n="AnonymousTemplate"+(++j);k.innerHTML+='<script type="text/xml" id="'+n+'" '+i+'="'+m+'">'+q+"</script>";return n}})();h.hashCode=function(n){var k=0;for(var l=0,m=n.length;l<m;l++){var j=n.charCodeAt(l);k=((k<<5)-k)+j;k=k&k}return k};return h});var g=g||{};g.base=g.base||{};b("wpfko.base.event",function(){var h=function(){this._registrations=[]};h.prototype.trigger=function(j){for(var k=0,l=this._registrations.length;k<l;k++){if(j instanceof g.base.routedEventArgs&&j.handled){return}this._registrations[k].callback.call(this._registrations[k].context,j)}};h.prototype.unRegister=function(j,k){k=k==null?window:k;for(var l=0,m=this._registrations.length;l<m;l++){if(this._registrations[l].callback===j&&this._registrations[l].context===k){this._registrations.splice(l,1);l--}}};h.prototype.dispose=function(){this._registrations.length=0};h.prototype.register=function(i,j){if(!(i instanceof Function)){throw"Invalid event callback"}var l=this._registrations;var k={callback:i,context:j==null?window:j,dispose:function(){var m=l.indexOf(k);if(m>=0){l.splice(m,1)}}};this._registrations.push(k);return{callback:k.callback,context:k.context,dispose:k.dispose}};return h});b("wpfko.base.if",function(){var i=true;var j=function(){if(!i){return}i=false;h.blankTemplateId=g.base.contentControl.createAnonymousTemplate("",true)};var h=g.base.contentControl.extend(function(){j();this._super.apply(this,arguments);this.condition=ko.observable();this.elseTemplateId=ko.observable(h.blankTemplateId);this.elseTemplateId.subscribe(this.elseTemplateChanged,this);this.elseTemplate=g.base.contentControl.createTemplatePropertyFor(this.elseTemplateId,this);this.__cachedTemplateId=this.templateId();this.condition.subscribe(this.onConditionChanged,this);this.templateId.subscribe(this.copyTemplateId,this);this.copyTemplateId(this.templateId())});h.prototype.elseTemplateChanged=function(k){if(!this.condition()){this.templateId(k)}};h.prototype.onConditionChanged=function(k){if(this.__oldConditionVal&&!k){this.templateId(this.elseTemplateId())}else{if(!this.__oldConditionVal&&k){this.templateId(this.__cachedTemplateId)}}this.__oldConditionVal=!!k};h.prototype.copyTemplateId=function(k){if(k!==this.elseTemplateId()){this.__cachedTemplateId=k}if(!this.condition()&&k!==this.elseTemplateId()){this.templateId(this.elseTemplateId())}};return h});b("wpfko.base.itemsControl",function(){var h;var j=function(){if(h){return}h=g.base.contentControl.createAnonymousTemplate("<div data-bind='itemsControl: null'></div>")};var i=g.base.contentControl.extend(function(l,k){j();this._super(l||h);this.itemTemplateId=ko.observable(k);this.itemTemplate=g.base.contentControl.createTemplatePropertyFor(this.itemTemplateId,this);this.itemSource=ko.observableArray([]);this.items=ko.observableArray([]);if(g.utils.ko.version()[0]<3){i.subscribeV2.call(this)}else{i.subscribeV3.call(this)}this.items.subscribe(this.syncModelsAndViewModels,this);var k=this.itemTemplateId.peek();this.itemTemplateId.subscribe(function(m){if(k!==m){try{this.reDrawItems()}finally{k=m}}},this)});i.subscribeV2=function(){var k=this.itemSource.peek();this.itemSource.subscribe(function(){try{if(this.modelsAndViewModelsAreSynched()){return}this.itemsChanged(ko.utils.compareArrays(k,arguments[0]||[]))}finally{k=g.utils.obj.copyArray(arguments[0]||[])}},this)};i.subscribeV3=function(){this.itemSource.subscribe(this.itemsChanged,this,"arrayChange")};i.prototype.syncModelsAndViewModels=function(){var k=false,n=false;var o=this.itemSource();if(o==null){n=true;o=[]}var p=this.items();if(o.length!==p.length){k=true;o.length=p.length}for(var l=0,m=p.length;l<m;l++){if(p[l].model()!==o[l]){o[l]=p[l].model();k=true}}if(k){if(n){this.itemSource(o)}else{this.itemSource.valueHasMutated()}}};i.prototype.modelsAndViewModelsAreSynched=function(){var m=this.itemSource()||[];var n=this.items()||[];if(m.length!==n.length){return false}for(var k=0,l=m.length;k<l;k++){if(m[k]!==n[k].model()){return false}}return true};i.prototype.itemsChanged=function(l){var q=this.items();var m=[],k=[],r={},n=0;for(var o=0,p=l.length;o<p;o++){if(l[o].status===g.utils.ko.array.diff.retained){continue}else{if(l[o].status===g.utils.ko.array.diff.deleted){m.push((function(s){return function(){var t=q.splice(s.index+n,1)[0];if(s.moved!=null){r[s.moved+"."+s.index]=t}n--}})(l[o]))}else{if(l[o].status===g.utils.ko.array.diff.added){k.push((function(s){return function(){var t=s.moved!=null?r[s.index+"."+s.moved]:this.createItem(s.value);q.splice(s.index,0,t)}})(l[o]))}else{throw"Unsupported status"}}}}for(o=0,p=m.length;o<p;o++){m[o].call(this)}for(o=0,p=k.length;o<p;o++){k[o].call(this)}this.items.valueHasMutated()};i.prototype.itemRendered=function(k){};i.prototype.itemDeleted=function(k){var l=this.renderedChildren.indexOf(k);if(l!==-1){this.renderedChildren.splice(l,1)}k.dispose()};i.prototype.createItem=function(k){return new g.base.view(this.itemTemplateId(),k)};i.prototype.reDrawItems=function(){var m=this.itemSource()||[];var n=this.items();n.length=m.length;for(var k=0,l=m.length;k<l;k++){n[k]=this.createItem(m[k])}this.items.valueHasMutated()};return i});b("wpfko.base.routedEvent",function(){var h=function(){};h.prototype.trigger=function(j,i){j.triggerRoutedEvent(this,new g.base.routedEventArgs(i,j))};h.prototype.unRegister=function(i,k,j){k.unRegisterRoutedEvent(this,i,j)};h.prototype.register=function(i,k,j){k.registerRoutedEvent(this,i,j)};return h});b("wpfko.base.routedEventArgs",function(){var h=function(i,j){this.handled=false;this.data=i;this.originator=j};return h});b("wpfko.base.routedEventRegistration",function(){var h=function(i){this.routedEvent=i;this.event=new g.base.event()};h.prototype.dispose=function(){this.event.dispose()};return h});a("itemsControl",true,function(){var h=function(m,n,k,o,l){if(!(o instanceof g.base.itemsControl)){throw"This binding can only be used within the context of a wo.itemsControl"}ko.virtualElements.emptyNode(m);if(g.utils.ko.version()[0]<3){j.subscribeV2(m,o,l)}else{j.subscribeV3(m,o,l)}i(m,o,l)(ko.utils.compareArrays([],o.items.peek()))};var i=function(l,m,k){return function(o){var p=[],n=[],t={},q=0;for(var r=0,s=o.length;r<s;r++){if(o[r].status===g.utils.ko.array.diff.retained){continue}else{if(o[r].status===g.utils.ko.array.diff.deleted){p.push((function(u){return function(){var v;if(u.moved!=null){t[u.moved+"."+u.index]={vm:u.value,elements:u.value._rootHtmlElement.__wpfko.allElements()};d(t[u.moved+"."+u.index].elements,function(w){w.parentNode.removeChild(w)})}else{m.itemDeleted(u.value)}q--}})(o[r]))}else{if(o[r].status===g.utils.ko.array.diff.added){n.push((function(u){return function(){var y=m.items.indexOf(u.value);if(u.moved!=null){var z=t[u.index+"."+u.moved];if(y===0){for(var A=z.elements.length-1;A>=0;A--){ko.virtualElements.prepend(l,z.elements[A])}}else{var w=m.items.peek()[y-1];for(var A=z.elements.length-1;A>=0;A--){w._rootHtmlElement.__wpfko.insertAfter(z.elements[A])}}}else{var x=g.utils.html.createWpfkoComment();if(y===0){ko.virtualElements.prepend(l,x.close);ko.virtualElements.prepend(l,x.open)}else{m.items.peek()[y-1]._rootHtmlElement.__wpfko.insertAfter(x.close);m.items.peek()[y-1]._rootHtmlElement.__wpfko.insertAfter(x.open)}var v=function(){return u.value};g.bindings.render.init(x.open,v,v,m,k);g.bindings.render.update(x.open,v,v,m,k);m.itemRendered(u.value)}}})(o[r]))}else{throw"Unsupported status"}}}}for(r=0,s=p.length;r<s;r++){p[r].call(this)}for(r=0,s=n.length;r<s;r++){n[r].call(this)}if(c){j.addComments(m.items())}}};var j={subscribeV2:function(l,o,k){var n=g.utils.obj.copyArray(o.items.peek());var m=j.itemsChanged(l,o,k);o.items.subscribe(function(){try{var p=ko.utils.compareArrays(n,arguments[0]||[]);m(p)}finally{n=g.utils.obj.copyArray(o.items.peek())}})},subscribeV3:function(l,m,k){m.items.subscribe(j.itemsChanged(l,m,k),window,"arrayChange")},itemsChanged:i,addComments:function(k){d(k,function(m,l){g.bindings["wipeout-comment"].comment(m._rootHtmlElement,"itemsControl item: "+l.toString())})}};return{init:h,utils:j}});a("namedRender",true,function(){var i=function(m,n,k,o,l){return ko.bindingHandlers.template.init.call(this,m,g.bindings.namedRender.utils.createValueAccessor(n),k,n(),l)};var j=function(o,q,l,r,m){var n=g.utils.ko.peek(g.utils.ko.peek(q()).item);if((r&&!(r instanceof g.base.visual))||(n&&!(n instanceof g.base.visual))){throw"This binding can only be used to render a wo.visual within the context of a wo.visual"}var k=this;var p=function(){ko.bindingHandlers.template.update.call(k,o,g.bindings.namedRender.utils.createValueAccessor(q),l,n,m)};if(n){if(n._rootHtmlElement){throw"This visual has already been rendered"}ko.utils.domData.set(o,g.bindings.wpfko.utils.wpfkoKey,n);n._rootHtmlElement=o;if(r){if(r===n){throw"A wo.view cannot be a child of itself."}r.renderedChildren.push(n)}n.templateId.subscribe(p)}p()};var h=function(k){return function(){var m=ko.utils.unwrapObservable(k());var l=ko.utils.unwrapObservable(m.item);return{templateEngine:g.template.engine.instance,name:l?l.templateId.peek():"",data:m.item||{},afterRender:l?function(p,o){var q=l.nodes||[];l.nodes=p;l.rootHtmlChanged(q,p);var n=ko.utils.unwrapObservable(m.comment);if(n&&c){g.bindings["wipeout-comment"].comment(l._rootHtmlElement,n)}}:undefined}}};return{init:i,update:j,utils:{createValueAccessor:h}}});a("render",true,function(){var i=function(m,n,k,o,l){return g.bindings.namedRender.init.call(this,m,g.bindings.render.utils.createValueAccessor(n),k,o,l)};var j=function(m,n,k,o,l){return g.bindings.namedRender.update.call(this,m,g.bindings.render.utils.createValueAccessor(n),k,o,l)};var h=function(k){return function(){return{item:k()}}};return{init:i,update:j,utils:{createValueAccessor:h}}});a("renderFromScript",true,function(){var h=function(k,n,i,o,j){var m=g.template.engine.scriptCache[n()](j);if(m.id){o.templateItems[m.id]=m.vm}var l=g.bindings.render.init.call(this,k,function(){return m.vm},i,o,j);g.bindings.render.update.call(this,k,function(){return m.vm},i,o,j);return l};return{init:h}});a("wipeout-comment",true,function(){var j="wipeout-comment";var i=function(m,n,k,o,l){h(m,ko.utils.unwrapObservable(n()))};var h=function(l,k){if(g.utils.ko.virtualElements.isVirtual(l)){l[j]=l[j]||l.textContent;l.textContent=l[j]+j+": '"+k.replace("'","'")+"' "}else{if(l&&l.parentElement){if(!l[j]){l.parentElement.insertBefore(l[j]=document.createComment(""),l)}l[j].textContent=" "+j+": '"+k.replace("'","'")+"' "}}};return{update:i,comment:h}});a("wpfko",true,function(){var i=function(l,o,j,q,k){if(ko.utils.domData.get(l,g.bindings.wpfko.utils.wpfkoKey)){throw"This element is already bound to another model"}var n=o();if(!n){throw"Invalid view type"}var p=new n();if(!(p instanceof g.base.view)){throw"Invalid view type"}p.model(q);var m=ko.bindingHandlers.render.init.call(this,l,h(p),j,null,k);ko.bindingHandlers.render.update.call(this,l,h(p),j,null,k);p.applicationInitialized();return m};var h=function(j){return function(){return j}};return{init:i,utils:{createValueAccessor:h,wpfkoKey:"__wpfko"}}});b("wpfko.template.engine",function(){var h=function(){};h.prototype=new ko.templateEngine();h.createJavaScriptEvaluatorFunction=function(i){return new Function("bindingContext","with(bindingContext) {\n\twith($data) {\n\t\treturn "+i+";\n\t}\n}")};h.createJavaScriptEvaluatorBlock=function(i){var j=h.newScriptId();if(i instanceof Function){h.scriptCache[j]=i}else{h.scriptCache[j]=h.createJavaScriptEvaluatorFunction(i)}return h.openCodeTag+j+h.closeCodeTag};h.prototype.createJavaScriptEvaluatorBlock=function(i){return h.createJavaScriptEvaluatorBlock(i)};h.prototype.rewriteTemplate=function(k,i,l){var j=document.getElementById(k);this.wipeoutRewrite(j);if(!h.scriptHasBeenReWritten.test(j.textContent)){ko.templateEngine.prototype.rewriteTemplate.call(this,k,i,l)}else{}this.makeTemplateSource(k,l).data("isRewritten",true)};h.wipeoutRewrite=function(k){if(g.base.visual.reservedTags.indexOf(k.nodeName)!==-1){d(k.childNodes,function(l){if(l.nodeType===1){h.wipeoutRewrite(l)}})}else{var i=h.newScriptId();h.scriptCache[i]=function(m){var n=g.utils.obj.createObject(k.nodeName);var l=m.createChildContext(n);n.initialize(k,l);return{vm:n,bindingContext:l,id:h.getId(k)}};var j=" ko renderFromScript: "+i;if(c){j+=", wipeout-comment: '"+k.nodeName+"'"}k.parentElement.insertBefore(document.createComment(j),k);k.parentElement.insertBefore(document.createComment(" /ko "),k);k.parentElement.removeChild(k)}};h.getId=function(l){for(var j=0,k=l.attributes.length;j<k;j++){if(l.attributes[j].nodeName==="id"){return l.attributes[j].value}}return null};h.prototype.wipeoutRewrite=function(k){var m=new XMLSerializer();xmlTemplate=new DOMParser().parseFromString("<root>"+k.textContent+"</root>","application/xml").documentElement;if(xmlTemplate.firstChild&&xmlTemplate.firstChild.nodeName==="parsererror"){throw"Invalid xml template:\n"+m.serializeToString(xmlTemplate.firstChild)}var l=[];for(var j=0;j<xmlTemplate.childNodes.length;j++){if(xmlTemplate.childNodes[j].nodeType===1){h.wipeoutRewrite(xmlTemplate.childNodes[j])}l.push(m.serializeToString(xmlTemplate.childNodes[j]))}k.textContent=l.join("")};h.prototype.renderTemplateSource=function(m,i,k){if(!(i.$data instanceof g.base.view)){return[]}var j=m.data("precompiled");if(!j){j=new g.template.htmlBuilder(m.text());m.data("precompiled",j)}var l;ko.dependentObservable(function(){l=j.render(i)},this).dispose();return l};h.newScriptId=(function(){var j=Math.floor(Math.random()*10000);return function(){return(++j).toString()}})();h.scriptCache={};h.openCodeTag="<!-- wpfko_code: {";h.closeCodeTag="} -->";h.scriptHasBeenReWritten=RegExp(h.openCodeTag.replace("{","{")+"[0-9]+"+h.closeCodeTag.replace("}","}"));h.instance=new h();return h});b("wpfko.template.htmlBuilder",function(){var h=function(i){this.preRendered=[];this.generatePreRender(i)};h.prototype.render=function(j){var k=[];var p=[];for(var m=0,n=this.preRendered.length;m<n;m++){if(this.preRendered[m] instanceof Function){var o=this.preRendered[m](j);p.push(o)}else{p.push(this.preRendered[m])}}var l=g.utils.html.createElements(p.join(""));d(h.getTemplateIds({childNodes:l}),function(q,i){j.$data.templateItems[i]=q});if(j.$data instanceof g.base.view){j.$data.onInitialized()}return l};h.prototype.generatePreRender=function(o){var p=new DOMParser().parseFromString("<root>"+o+"</root>","application/xml").documentElement;if(p.firstChild&&p.firstChild.nodeName==="parsererror"){var l=new XMLSerializer();throw"Invalid xml template:\n"+l.serializeToString(p.firstChild)}var k=g.template.engine.openCodeTag;var i=g.template.engine.closeCodeTag;var n=g.template.htmlBuilder.generateTemplate(p);this.preRendered.length=0;var m,j;while((m=n.indexOf(k))!==-1){this.preRendered.push(n.substr(0,m));n=n.substr(m);j=n.indexOf(i);if(j===-1){throw"Invalid wpfko_code tag."}this.preRendered.push((function(q){return function(r){return g.template.engine.scriptCache[q](r)}})(n.substr(k.length,j-k.length)));n=n.substr(j+i.length)}this.preRendered.push(n)};h.getTemplateIds=function(i){var j={};d(i.childNodes,function(m){if(m.nodeType===1){for(var k=0,l=m.attributes.length;k<l;k++){if(m.attributes[k].nodeName==="id"){j[m.attributes[k].nodeValue]=m;break}}d(h.getTemplateIds(m),function(n,o){j[o]=n})}});return j};h.generateTemplate=function(k){var i=[];var j=new XMLSerializer();d(k.childNodes,function(m){if(m.nodeType==1){var l=new DOMParser().parseFromString(j.serializeToString(m),"application/xml").documentElement;while(l.childNodes.length){l.removeChild(l.childNodes[0])}var n=g.utils.html.createElement(j.serializeToString(l));n.innerHTML=g.template.htmlBuilder.generateTemplate(m);i.push(g.utils.html.outerHTML(n))}else{if(m.nodeType===3){i.push(m.data)}else{i.push(j.serializeToString(m))}}});return i.join("")};return h});b("wpfko.template.switchBindingContext",function(){return function(h){this.bindingContext=h}});b("wpfko.utils.html",function(){var o=function(t){if(!t){return null}if(t.constructor===HTMLHtmlElement){throw"Cannot serialize a Html element using outerHTML"}var u=t.nodeType===1?(p[t.tagName.toLowerCase()]||"div"):"div";var s=document.createElement(u);s.innerHTML=t.outerHTML;return s.innerHTML};var r=/[a-zA-Z0-9]/;var m=function(u){u=u.replace(/^\s+|\s+$/g,"");if(!u||u[0]!=="<"){throw"Invalid html tag"}u=u.substring(1).replace(/^\s+|\s+$/g,"");for(var s=0,t=u.length;s<t;s++){if(!r.test(u[s])){break}}return u.substring(0,s)};var q=/<\!--[^>]*-->/g;var l=function(s){s=s.replace(q,"").replace(/^\s+|\s+$/g,"");var t=0;if((t=s.indexOf("<"))===-1){return null}return m(s.substring(t))};var p={area:"map",base:"head",basefont:"head",body:"html",caption:"table",col:"colgroup",colgroup:"table",command:"menu",frame:"frameset",frameset:"html",head:"html",li:"ul",tbody:"table",td:"tr",tfoot:"table",th:"tr",thead:"table",tr:"tbody"};var h=function(t){if(!t){return null}var u=document.createElement(p[m(t)]||"div");u.innerHTML=t;var s=u.firstChild;u.removeChild(s);return s};var i=function(t){if(t==null){return[]}var w=l(t)||"div";var v=p[m("<"+w+"/>")]||"div";t="<"+w+"></"+w+">"+t+"<"+w+"></"+w+">";var s=document.createElement(v);s.innerHTML=t;var u=[];while(s.firstChild){u.push(s.firstChild);s.removeChild(s.firstChild)}u.splice(0,1);u.splice(u.length-1,1);return u};var j=function(){var t=document.createComment(" ko ");var s=document.createComment(" /ko ");t.__wpfko={open:t,close:s,"delete":function(){var u=t.__wpfko.allElements();for(var v=0,w=u.length;v<w;v++){u[v].parentNode.removeChild(u[v])}},allElements:function(){var v=[];var u=t;while(true){v.push(u);if(u===s){break}u=u.nextSibling}return v},insertAfter:function(u){return s.nextSibling?s.parentNode.insertBefore(u,s.nextSibling):s.parentNode.appendChild(u)}};return t.__wpfko};var k=function(u){var s=[];if(g.utils.ko.virtualElements.isVirtual(u)){var y=g.utils.ko.virtualElements.parentElement(u);for(var v=0,w=y.childNodes.length;v<w;v++){if(y.childNodes[v]===u){break}}v++;for(var w=y.childNodes.length;v<w;v++){s.push(y.childNodes[v])}}else{s=u.childNodes}var x=[];var t=0;for(var v=0,w=s.length;v<w;v++){if(g.utils.ko.virtualElements.isVirtualClosing(s[v])){t--;if(t<0){return x}continue}if(t>0){continue}x.push(s[v]);if(g.utils.ko.virtualElements.isVirtual(s[v])){t++}}return x};var n=function(s){return ko.utils.domData.get(s,g.bindings.wpfko.utils.wpfkoKey)};return{specialTags:p,getFirstTagName:l,getTagName:m,getAllChildren:k,outerHTML:o,createElement:h,createElements:i,createWpfkoComment:j,getViewModel:n}});b("wpfko.util.html",function(){return g.utils.html});b("wpfko.utils.ko",function(){var h={};h.version=function(){if(!ko||!ko.version){return null}var l=ko.version.split(".");for(var j=0,k=l.length;j<k;j++){l[j]=parseInt(l[j])}return l};h.peek=function(i){if(ko.isObservable(i)){return i.peek()}else{return i}};h.array={diff:{added:"added",deleted:"deleted",retained:"retained"}};h.isObservableArray=function(i){return ko.isObservable(i)&&i.push&&i.push.constructor===Function};h.virtualElements={parentElement:function(j){var i=j.previousSibling;while(i){if(h.virtualElements.isVirtual(i)){return i}i=i.previousSibling}return j.parentNode},isVirtual:function(i){return i.nodeType===8&&i.nodeValue.replace(/^\s+/,"").indexOf("ko")===0},isVirtualClosing:function(i){return i.nodeType===8&&i.nodeValue.replace(/^\s+|\s+$/g,"")==="/ko"},elementWithChildren:function(k){if(!k){return[]}if(!h.virtualElements.isVirtual(k)){return[k]}var l=[k];var j=1;var i=k.nextSibling;while(j>0){l.push(i);if(h.virtualElements.isVirtualClosing(i)){j--}else{if(h.virtualElements.isVirtual(i)){j++}}i=i.nextSibling}return l}};return h});b("wpfko.util.ko",function(){return g.utils.ko});window.wo={};d(g.base,function(j,h){window.wo[h]=j});window.wo.utils=g.utils;var c=wo.DEBUG=false})();