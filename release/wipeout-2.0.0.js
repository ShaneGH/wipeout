// wipeout v2.0.0
// (c) Shane Connon 2015
// http://www.opensource.org/licenses/mit-license.php
(function () {

// busybody v0.1.0
// (c) Shane Connon 2015
// http://www.opensource.org/licenses/mit-license.php
(function () {

// orienteer v0.1.0
// (c) Shane Connon 2015
// http://www.opensource.org/licenses/mit-license.php
!function(){function orienteer(){}var a={parents:[],children:[]};orienteer.clearVirtualCache=function(b){if(!b)return a.parents.length=0,void(a.children.length=0);for(var c=0,d=a.children.length;d>c;c++)(a.children[c]===b||a.parents[c]===b)&&(a.children.splice(c,1),a.parents.splice(c,1))},orienteer.useVirtualCache=!0,orienteer.prototype._super=function(){var b=arguments.callee.caller,c=null;if(orienteer.useVirtualCache){var d=a.children.indexOf(b);-1!==d&&(c=a.parents[d])}if(!c){for(var e=[],f=this.constructor.prototype;f;)e.push(f),f=Object.getPrototypeOf(f);e.reverse();for(var g=0,h=e.length;h>g;g++){if(e[g]===b.prototype)c=e[g-1].constructor;else for(var i in e[g]){if(e[g][i]===b)for(var j=g-1;j>=0;j--)if(e[j][i]!==b){c=e[j][i];break}if(c)break}if(c){orienteer.useVirtualCache&&(a.children.push(b),a.parents.push(c));break}}if(!c)throw"Could not find method in parent class"}return c.apply(this,arguments)};orienteer.extend=function(a){if(a.constructor===Function){var b=a;a={constructor:b,statics:{}};for(var c in a.constructor)a.statics[f]=a.constructor[f];for(var c in a.constructor.prototype)a[f]=a.constructor.prototype[f]}else if(a.constructor===Object)a.constructor=function(){this._super.apply(this,arguments)};else if(!a.constructor||a.constructor.constructor!==Function)throw'the property "constructor" must be a function';for(var d in this)this.hasOwnProperty(d)&&this[d]&&this[d].constructor===Function&&this[d]!==orienteer.clearVirtualCache&&this[d]!==orienteer.getInheritanceChain&&void 0===a.constructor[d]&&(a.constructor[d]=this[d]);var e=function(){this.constructor=a.constructor};e.prototype=this.prototype,a.constructor.prototype=new e;for(var f in a)if("constructor"!==f)if("statics"!==f)a.constructor.prototype[f]=a[f];else for(var g in a[f])a.constructor[g]=a[f][g];return a.constructor},orienteer.getInheritanceChain=function(a){for(var b=[];a;)b.push(a),a=Object.getPrototypeOf(a.prototype),a&&(a=a.constructor);return b},window.orienteer=orienteer}();

!function(a){function b(a,b,d,f){return function(g){var h=c.getObserver(a);if(g&&h.$bindingChanges)for(var i in h.$bindingChanges)if(d===h.$bindingChanges[i].fromObject&&g[g.length-1]===h.$bindingChanges[i].change)return;c.captureChanges(d,function(){c.utils.obj.setObject(f,d,c.utils.obj.getObject(b,a))},function(b){c.makeObservable(d);e(b,function(b){var e=c.getObserver(d);if(e){e.$bindingChanges||(e.$bindingChanges={});var f=k();e.$bindingChanges[f]={change:b,fromObject:a},setTimeout(function(){delete e.$bindingChanges[f];for(var a in e.$bindingChanges)return;delete e.$bindingChanges},100)}})})}}var c={},d=c.useObjectObserve=Object.observe&&(!window.hasOwnProperty("useObjectObserve")||window.useObjectObserve),e=function(a,b,c){if(a){c=c||window;for(var d=0,e=a.length;e>d;d++)b.call(c,a[d],d)}},f=function(a,b,c){if(a&&(c=c||window,null!=a))for(var d in a)b.call(c,a[d],d)},g=function(a,b){a=a.split(".");var c=a.splice(0,a.length-1),d={};return d[a[a.length-1]]=b(),h(c.join("."),d),d[a[a.length-1]]},h=function(a,b){if(a=a.split("."),"busybody"!==a[0])throw'Root must be "busybody".';a.splice(0,1);var d=c;e(a,function(a){d=d[a]||(d[a]={})}),b&&b instanceof Function&&(b=b()),f(b,function(a,b){d[b]=a})},i=/^\s+|\s+$/g,j=function(a){return a?a.replace(i,""):a};g("busybody.utils.obj",function(){function a(a,b){b||(b=window);for(var c=0,d=a.length;d>c;c++)if(b=b[a[c]],null==b)return c===d-1?b:null;return b}function b(a,b){a.push(b);var d=new c.disposable(function(){d&&(d=null,b=a.indexOf(b),-1!==b&&a.splice(b,1))});return d}var d=/\[\s*\d\s*\]$/g,g=function(a){a=a.split(".");for(var b,e=0;e<a.length;e++){a[e]=c.utils.obj.trim(a[e]);var f=a[e].match(d);if(f&&f.length){(b=c.utils.obj.trim(a[e].replace(d,"")))?a[e]=c.utils.obj.trim(a[e].replace(d,"")):(a.splice(e,1),e--);for(var g=0,h=f.length;h>g;g++)a.splice(++e,0,parseInt(f[g].match(/\d/)[0]))}}return a},h=function(a){var b=[];return e(a,function(a){b.push(isNaN(a)?0===b.length?a:"."+a:"["+a+"]")}),b.join("")},i=function(b,c){return a(g(b),c)},k=function(b,c,d){var e={};return b=g(b),e.remainder=0>=d?b.splice(b.length+d,-1*d):b.splice(d,b.length-d),e.object=a(b,c,d),e},l=function(b,c,d){b=g(b),b.length>1&&(c=a(b.splice(0,b.length-1),c)),c&&(c[b[0]]=d)},m=function(){};return m.trim=j,m.addWithDispose=b,m.enumerateArr=e,m.enumerateObj=f,m.getObject=i,m.getPartialObject=k,m.setObject=l,m.splitPropertyName=g,m.joinPropertyName=h,m}),g("busybody.disposable",function(){function b(a){a.$disposables||(a.$disposables={})}var c=a.extend(function(a){this._super(),a&&(a instanceof Function?this.registerDisposeCallback(a):this.registerDisposable(a))});return c.prototype.disposeOf=function(a){if(a instanceof Array){var b=!1;return e(a,function(a){b|=this.disposeOf(a)},this),b}return this.$disposables&&this.$disposables[a]?(this.$disposables[a](),delete this.$disposables[a]):!1},c.prototype.disposeOfAll=function(){if(this.$disposables)for(var a in this.$disposables)this.disposeOf(a)},c.prototype.registerDisposeCallback=function(){var a=0;return function(c){if(!c||c.constructor!==Function)throw"The dispose function must be a Function";b(this);var d=(++a).toString();return this.$disposables[d]=c,d}}(),c.prototype.registerDisposable=function(a){if(a){if(a.constructor!==Function||a.dispose||(a=a.call(this)),!(a&&a.dispose instanceof Function))throw"The disposable object must have a dispose(...) function";return this.registerDisposeCallback(a.dispose.bind(a))}},c.prototype.dispose=function(){this.disposeOfAll()},c}),g("busybody.utils.executeCallbacks",function(){var a=c.disposable.extend(function b(){if(this.constructor===b)throw"You cannot create an instance of an abstract class";this._super(),this.callbacks=[]});return a.prototype.addCallback=function(a){var b=c.utils.obj.addWithDispose(this.callbacks,a);return this.registerDisposable(b),b},a.prototype._execute=function(){throw"Abstract methods must be implemented"},a.prototype.execute=function(){var a=this._execute();a&&!a.cancel&&e(this.callbacks.slice(),function(b){b.apply(null,a.arguments||[])})},a.prototype.dispose=function(){this._super(),this.callbacks.length=0},a}),g("busybody.observeTypes.observeTypesBase",function(){var a=c.utils.executeCallbacks.extend(function b(){if(this.constructor===b)throw"You cannot create an instance of an abstract class";this._super()});return a.prototype.getValue=function(){throw"Abstract methods must be implemented"},a.prototype._execute=function(){var a=this.val;return this.val=this.getValue(),{cancel:this.val===a,arguments:[a,this.val]}},a}),g("busybody.observableBase",function(){var a=c.disposable.extend(function(a){this._super(),this.$changeBatch=[],this.$forObject=a,this.$callbacks={}});return a.prototype.registerChangeBatch=function(a){this.$changeBatch.length||setTimeout(this.processChangeBatch.bind(this)),this.$changeBatch.push.apply(this.$changeBatch,a)},a.prototype.processChangeBatch=function(){var b={};e(this.$changeBatch,function(a){b[a.name]||(b[a.name]=[]),b[a.name].push(a)}),this.$changeBatch.length=0,c.utils.observeCycleHandler.instance.execute(this.$forObject||this,function(){var c=[];f(b,function(b,d){this.$callbacks[d]&&c.push.apply(c,a.processChanges(this.$callbacks[d],b))},this),e(c,function(a){a()})}.bind(this))},a.processChanges=function(a,b){var c=[],d=[];e(a,function(a,e){if(a.evaluateOnEachChange)for(var e=0,f=b.length;f>e;e++)a.evaluateSingle(b,e)&&c.push(e);else d.push(function(){a.evaluateMultiple(b)&&c.push(e)})}),c.sort(function(a,b){return b>a});for(var f=0,g=c.length;g>f;f++)a.splice(c[f],1);return d},a.prototype.onNextPropertyChange=function(){throw"Abstract methods must be overridden"},a.prototype.captureChanges=function(a,b,d){if(d&&(d=c.utils.obj.splitPropertyName(d)).length>1)return c.captureChanges(c.utils.obj.getObject(d.slice(0,d.length-1).join("."),this.$forObject||this),a,b,d[d.length-1]);d=d&&d.length?d[0]:void 0;var f=d?function(a){var c=[];e(a,function(a){a.name==d&&c.push(a)}),b(c)}:b.bind(this);return d&&this._init(d),this._captureChanges(a,f)},a.prototype._captureChanges=function(){throw"Abstract methods must be overridden"},a.prototype.bind=function(a,b,d){return c.bind(this,a,b,d)},a.prototype.observeArray=function(a,b,d,e){var f,g,h=this.observe(a,function(a,g){f&&(this.disposeOf(f),f=null);var h={object:g||[],index:0,addedCount:g instanceof Array?g.length:0,removed:a instanceof Array?a:[],type:"splice"};if(e&&e.evaluateOnEachChange)b.call(d,h);else{var i=new c.utils.compiledArrayChange([h],0,1);b.call(d,i.getRemoved(),i.getAdded(),i.getIndexes())}g instanceof c.array&&(f=this.registerDisposable(g.observe(b,d,e)))},this);return(g=c.utils.obj.getObject(a,this.$forObject||this))instanceof c.array&&(f=this.registerDisposable(g.observe(b,d,e))),new c.disposable(function(){f&&(this.disposeOf(f),f=null),h&&(h.dispose(),h=null)})},a.prototype.observe=function(a,b,d,e){if(/[\.\[]/.test(a)){var f=new c.observeTypes.pathObserver(this.$forObject||this,a,b,d);return this.registerDisposable(f),f}this._init(a);var g=new c.callbacks.propertyCallback(b,d,e);this.$callbacks[a]||(this.$callbacks[a]=[]),this.$callbacks[a].push(g),e&&e.activateImmediately?g.activate():this.onNextPropertyChange(a,function(a){g.activate(a)});var h={dispose:function(b){h&&(h=null,b?this.onNextPropertyChange(a,function(a){g.deactivate(a)}):g.deactivate())}.bind(this)};return this.registerDisposable(h),h},a.prototype._init=function(){throw"Abstract methods must be implemented"},a.prototype.dispose=function(){this._super(),delete this.$forObject;for(var a in this.$callbacks)delete this.$callbacks[a]},a.prototype.computed=function(a,b,d){var e=new c.observeTypes.computed(b,this.$forObject||this,d);return e.bind(this.$forObject||this,a),this.registerDisposable(e),e},a.prototype.del=function(a){delete(this.$forObject||this)[a]},a.afterObserveCycle=function(a){return c.utils.observeCycleHandler.instance.afterObserveCycle(a)},a.beforeObserveCycle=function(a){return c.utils.observeCycleHandler.instance.beforeObserveCycle(a)},a.afterNextObserveCycle=function(a,b){if(!b&&0===c.utils.observeCycleHandler.instance.length)return void a();var d=c.utils.observeCycleHandler.instance.afterObserveCycle(function(){d.dispose(),a()});return d},a.beforeNextObserveCycle=function(a){var b=c.utils.observeCycleHandler.instance.beforeObserveCycle(function(){b.dispose(),a()});return b},a}),g("busybody.callbacks.changeCallback",function(){var b=a.extend(function(a){this._super(),this.evaluateOnEachChange=a});return b.dispose={},b.prototype.activate=function(a){if(this._activated||this._activatingChange)throw"This callback has been activated";if(arguments.length){if(null==a)throw"Invalid change";this._activatingChange=a}else this._activated=!0},b.prototype.deactivate=function(a){if(this._deactivatingChange)throw"This callback has a deactivate pending";if(arguments.length){if(null==a)throw"Invalid change";this._deactivatingChange=a}else this._activated=!1},b.prototype.evaluateSingle=function(a,c){if(this.evaluateOnEachChange){if(this._activated===!1||this.hasOwnProperty("_deactivatingChange")&&this._deactivatingChange===a[c])return this._activated=!1,b.dispose;if(!this.hasOwnProperty("_activated")){if(!this.hasOwnProperty("_activatingChange")||this._activatingChange!==a[c])return;this._activated=!0,delete this._activatingChange}this._evaluateSingle(a,c)}},b.prototype._evaluateSingle=function(){throw"Abstract methods must be implemented"},b.prototype.evaluateMultiple=function(a){if(!this.evaluateOnEachChange&&a.length){if(this._activated===!1)return b.dispose;var c=0,d=a.length,e=void 0;return this.hasOwnProperty("_activated")||(c=a.indexOf(this._activatingChange),-1!==c&&(this._activated=!0,delete this._activatingChange)),this._deactivatingChange&&(d=a.indexOf(this._deactivatingChange),-1===d?d=a.length:(e=b.dispose,this._activated=!1,delete this._deactivatingChange)),-1!==c&&d>c&&this._evaluateMultiple(a,c,d),e}},b.prototype._evaluateMultiple=function(){throw"Abstract methods must be implemented"},b}),g("busybody.arrayBase",function(){function b(a){return"number"==typeof a&&a%1===0?a:null===a?0:"boolean"==typeof a?a?1:0:"string"!=typeof a||isNaN(a=parseFloat(a))||a%1!==0?void 0:a}var d=a.extend.call(Array,function(a){if(Array.call(this),arguments.length&&!(arguments[0]instanceof Array))throw"The initial values must be an array";if(this.$disposables=[],this.$boundArrays=[],this.$callbacks=[],this.$changeBatch=[],this.$length=a?a.length:0,a)for(var b=0,c=a.length;c>b;b++)this[b]=a[b]});d.prototype._super=a.prototype._super,d.extend=a.extend,d.isValidArrayChange=function(a){return"splice"===a.type||!isNaN(parseInt(a.name))},d.prototype.onNextArrayChange=function(){throw"Abstract methods must be implemented"},d.prototype.processChangeBatch=function(){var a=this.$changeBatch.slice();this.$changeBatch.length=0,c.utils.observeCycleHandler.instance.execute(this,function(){e(c.observableBase.processChanges(this.$callbacks,a),function(a){a()})}.bind(this))},d.prototype.registerChangeBatch=function(a){for(var b=a.length-1;b>=0;b--)d.isValidArrayChange(a[b])||a.splice(b,1);return c.observableBase.prototype.registerChangeBatch.call(this,a)},Object.defineProperty(d.prototype,"length",{set:function(a){if(void 0===(a=b(a)))throw RangeError("Invalid array length");if(a!==this.$length){if(!this.__alteringArray)if(a>this.$length){var c=new Array(a-this.length+2);c[0]=this.length,c[1]=0,this.splice.apply(this,c)}else a<this.$length&&this.splice(a,this.length-a);this.$length=a}},get:function(){return this.$length}}),d.prototype._init=function(){throw"Abstract methods must be implemented"},d.prototype.observe=function(a,b,d){if("string"==typeof arguments[0]){var e=Array.prototype.slice.call(arguments);return e.splice(0,0,this),c.observe.apply(null,e)}return this.addCallback(new c.callbacks.arrayCallback(a,b,d))},d.prototype.disposableFor=function(a){var b={dispose:function(c){b&&(b=null,c?this.onNextArrayChange(function(b){a.deactivate(b)}):a.deactivate())}.bind(this)};return b};var f="busybody-do-not-apply-to";return d.prototype.alteringArray=function(a,b){if(this.__alteringArray)throw"Calls to alteringArray must be synchronus and not nested.";try{return this.__alteringArray=!0,e(this.$boundArrays,function(c){if(c[f])throw"Circular reference in array bindings found";this[f]!==c&&(c[f]=this,c[a].apply(c,b))},this),Array.prototype[a].apply(this,b)}finally{this.__alteringArray=!1,e(this.$boundArrays,function(a){delete a[f]})}},d.copyAll=function(a,b,c){var d;c?(d=[],e(a,function(a){d.push(c(a))})):d=a.slice(),d.splice(0,0,0,b.length),b.splice.apply(b,d)},d.prototype.bind=function(a){return a&&-1===this.$boundArrays.indexOf(a)?(this.$boundArrays.push(a),a instanceof c.array&&-1!==a.$boundArrays.indexOf(this)||d.copyAll(this,a),new c.disposable(function(){if(a){var b;-1!==(b=this.$boundArrays.indexOf(a))&&this.$boundArrays.splice(b,1),a=null}}.bind(this))):void 0},d.prototype.addCallback=function(a){this._init(),this.$callbacks.push(a),this.onNextArrayChange(function(b){a.activate(b)});var b=this.disposableFor(a);return this.$disposables.push(b),b},d.prototype.dispose=function(){e(this.$disposables,function(a){a.dispose()}),this.$disposables.length=0,this.$boundArrays.length=0,this.$callbacks.length=0},d}),d?g("busybody.array",function(){var a=c.arrayBase.extend(function b(a){return this===c?new b(a):void this._super.apply(this,arguments)});return a.prototype.onNextArrayChange=function(a){var b=function(d){if(b)for(var e=0,f=d.length;f>e;e++)if(c.arrayBase.isValidArrayChange(d[e]))return Array.unobserve(this,b),b=null,void a(d[e])}.bind(this);Array.observe(this,b)},a.prototype.captureArrayChanges=function(a,b){var d=function(a){a=a.slice();for(var d=a.length-1;d>=0;d--)c.arrayBase.isValidArrayChange(a[d])||a.splice(d,1);b(a)};Array.observe(this,d),a(),Array.unobserve(this,d)},a.prototype._init=function(){this.__subscription||(this.__subscription=this.registerChangeBatch.bind(this),Array.observe(this,this.__subscription))},a.prototype.dispose=function(){this._super(),this.__subscription&&(Array.unobserve(this,this.__subscription),delete this.__subscription)},a}):g("busybody.array",function(){var a=c.arrayBase.extend(function b(a){return this===c?new b(a):(this._super.apply(this,arguments),this.$onNextArrayChanges=[],void(this.$captureCallbacks=[]))});return a.prototype.captureArrayChanges=function(a,b){var d=function(a){a=a.slice();for(var d=a.length-1;d>=0;d--)c.arrayBase.isValidArrayChange(a[d])||a.splice(d,1);b(a)};this.$captureCallbacks.push(d),a(),this.$captureCallbacks.splice(this.$captureCallbacks.indexOf(d),1)},a.prototype.registerChangeBatch=function(a){for(var b=0,d=a.length;d>b;b++)if(c.arrayBase.isValidArrayChange(a[b])){e(this.$onNextArrayChanges.splice(0,this.$onNextArrayChanges.length),function(c){c(a[b])});break}return e(this.$captureCallbacks,function(b){b(a)}),this._super(a)},a.prototype.onNextArrayChange=function(a){this.$onNextArrayChanges.push(a)},a.prototype._init=function(){},a}),function(){var a=c.array;a.prototype.replace=function(a,b){return this.splice(a,a>=this.length?0:1,b),b},a.prototype.pop=function(){return d||this.length&&this.registerChangeBatch([{addedCount:0,index:this.length-1,object:this,removed:[this[this.length-1]],type:"splice"}]),this.alteringArray("pop")},a.prototype.shift=function(){return d||this.length&&this.registerChangeBatch([{addedCount:0,index:0,object:this,removed:[this[0]],type:"splice"}]),this.alteringArray("shift")},a.prototype.remove=function(a){var b;return-1!==(b=this.indexOf(a))?(this.splice(b,1),!0):!1},a.prototype.push=function(){return d||this.registerChangeBatch([{addedCount:arguments.length,index:this.length,object:this,removed:[],type:"splice"}]),this.alteringArray("push",arguments)},a.prototype.reverse=function(){var a=this.length;if(!(2>a)){if(!d){for(var b,c=Math.floor(a/2),e=[],f=0;c>f;f++)e.push({name:f.toString(),object:this,oldValue:this[f],type:"update"}),b=a-f-1,e.push({name:b.toString(),object:this,oldValue:this[b],type:"update"});this.registerChangeBatch(e)}return this.alteringArray("reverse")}},a.prototype.sort=function(){if(!d){for(var a=this.slice(),b=[],c=this.alteringArray("sort",arguments),e=0,f=a.length;f>e;e++)a[e]!==this[e]&&b.push({name:e.toString(),object:this,oldValue:a[e],type:"update"});return this.registerChangeBatch(b),c}return this.alteringArray("sort",arguments)},a.prototype.splice=function(a,b){if(!d){for(var c=[],e=a,f=b+a>this.length?this.length:b+a;f>e;e++)c.push(this[e]);this.registerChangeBatch([{addedCount:arguments.length-2,index:a,object:this,removed:c,type:"splice"}])}return this.alteringArray("splice",arguments)}}(),g("busybody.callbacks.arrayCallback",function(){var a=c.callbacks.changeCallback.extend(function(a,b,c){this._super(c&&c.evaluateOnEachChange),this.useRawChanges=c&&c.useRawChanges,this.callback=a,this.context=b});return a.prototype._evaluateSingle=function(a,b){this.callback.call(this.context,a[b])},a.prototype._evaluateMultiple=function(a,b,d){if(this.useRawChanges)return void this.callback.call(this.context,a.slice(b,d));a.compiled||(a.compiled=[]);for(var e,f=0,g=a.compiled.length;g>f;f++)if(a.compiled[f].areEqual(b,d)){e=a.compiled[f];break}e||a.compiled.push(e=new c.utils.compiledArrayChange(a,b,d)),this._evaluateArrayMultiple(e)},a.prototype._evaluateArrayMultiple=function(a){this.callback.call(this.context,a.getRemoved(),a.getAdded(),a.getIndexes())},a}),g("busybody.callbacks.propertyCallback",function(){var a=c.callbacks.changeCallback.extend(function(a,b,c){this._super(c&&c.evaluateOnEachChange),this.callback=a,this.context=b,this.evaluateIfValueHasNotChanged=c&&c.evaluateIfValueHasNotChanged,this.useRawChanges=c&&c.useRawChanges});return a.prototype._evaluateSingle=function(a,b){var c=a[b],d=a[b+1],e=d?d.oldValue:c.object[c.name];this.useRawChanges?this.callback.call(this.context,c):(this.evaluateIfValueHasNotChanged||e!==c.oldValue)&&this.callback.call(this.context,c.oldValue,e)},a.prototype._evaluateMultiple=function(a,b,c){var d=a[c]?a[c].oldValue:a[0].object[a[0].name];this.useRawChanges?this.callback.call(this.context,a.slice(b,c)):(this.evaluateIfValueHasNotChanged||d!==a[b].oldValue)&&this.callback.call(this.context,a[b].oldValue,d)},a});d?g("busybody.observable",function(){var a=c.observableBase.extend(function(a){this._super(a)});return a.prototype.onNextPropertyChange=function(a,b){var c=function(d){if(c)for(var e=0,f=d.length;f>e;e++)if(d[e].name==a){var g=c;return Object.unobserve(this.$forObject||this,g),c=null,void b(d[e])}}.bind(this);Object.observe(this.$forObject||this,c)},a.prototype._captureChanges=function(a,b){Object.observe(this.$forObject||this,b),a(),Object.unobserve(this.$forObject||this,b)},a.prototype._init=function(){this.__subscribeCallback||(this.__subscribeCallback=this.registerChangeBatch.bind(this),Object.observe(this.$forObject||this,this.__subscribeCallback))},a.prototype.dispose=function(){this._super(),this.__subscribeCallback&&(Object.unobserve(this.$forObject||this,this.__subscribeCallback),delete this.__subscribeCallback)},a}):g("busybody.observable",function(){function a(a){return a.$observer||a}var b=c.observableBase.extend(function(a){this._super(a),this.$observed={},this.$onNextPropertyChanges={},this.$captureCallbacks=[]});return b.prototype.onNextPropertyChange=function(a,b){(this.$onNextPropertyChanges[a]||(this.$onNextPropertyChanges[a]=[])).push(b)},b.prototype._captureChanges=function(a,b){this.$captureCallbacks.push(b),a(),this.$captureCallbacks.splice(this.$captureCallbacks.indexOf(b),1)},b.prototype._init=function(b){this.$observed.hasOwnProperty(b)||((this.$forObject||this).hasOwnProperty(b)&&(this.$observed[b]=(this.$forObject||this)[b]),Object.defineProperty(this.$forObject||this,b,{get:function(){return a(this).$observed[b]},set:function(c){var d=a(this),f={type:d.$observed.hasOwnProperty(b)?"update":"add",name:b,object:this,oldValue:d.$observed[b]};if(d.$observed[b]=c,d.$onNextPropertyChanges[b]){var g=d.$onNextPropertyChanges[b];delete d.$onNextPropertyChanges[b],setTimeout(function(){e(g,function(a){a(f)})})}d.addChange(f)},enumerable:!0,configurable:!0}))},b.prototype.addChange=function(a){this.__changeToken||(this.__changeToken=[],setTimeout(function(){var a=this.__changeToken;delete this.__changeToken,this.registerChangeBatch(a)}.bind(this))),this.__changeToken.push(a),e(this.$captureCallbacks,function(b){b([a])})},b.prototype.del=function(a){(this.$forObject||this)[a]=void 0,this._super(a)},b.prototype.dispose=function(){this._super();for(var a in this.$onNextPropertyChanges)delete this.$onNextPropertyChanges[a]},b});g("busybody.observeTypes.computed",function(){var a=/\s*with\s*\(/g,b=/([^\s,]+)/g,d=/\/\/.*$/gm,f=/\/\*[\s\S]*?\*\//gm,g="((\\s*\\.\\s*([\\w\\$]*))|(\\s*\\[\\s*\\d\\s*\\]))+",h={},i=c.observeTypes.observeTypesBase.extend(function l(a,c,d){if(this._super(),d=d||{},this.arguments=[],d.observeArrayElements&&(this.possibleArrays=[]),this.callbacks=[],this.callbackString=l.stripFunction(a),this.callbackFunction=a,this.context=c,!d.allowWith&&l.testForWith(this.callbackString))throw'You cannot use the "with" keyword in computed functions by default. To allow "with", use the allowWith flag on the options argument of the constructor, however, properties of the variable within the "with" statement cannot be monitored for change.';var f=this.callbackString.slice(this.callbackString.indexOf("(")+1,this.callbackString.indexOf(")")).match(b)||[];if(d.watchVariables&&f.length){var g;for(var i in d.watchVariables)-1!==(g=f.indexOf(i))&&(this.arguments[g]=d.watchVariables[i],f[g]=h)}if(e(f,function(a){if(a!==h)throw'Argument "'+a+'" must be added as a watch variable.'}),this.watchVariable("this",c,d.observeArrayElements),d.watchVariables)for(var i in d.watchVariables)this.watchVariable(i,d.watchVariables[i],d.observeArrayElements);d.delayExecution||this.execute()});i.testForWith=function(b){for(a.lastIndex=0;a.exec(b);)if(!/[\.\w\$]/.test(b[a.lastIndex-1]))return!0;return!1},i.prototype.rebuildArrays=function(){e(this.possibleArrays,function(a){a.disposeKeys&&a.disposeKeys.length&&(this.disposeOf(a.disposeKeys),a.disposeKeys.length=0);var b=a.path.length?c.utils.obj.getObject(a.path,a.root):a.root;b instanceof Array&&(a.disposeKeys=a.disposeKeys||[],e(b,function(b){e(a.subPaths,function(c){a.disposeKeys.push(this.addPathWatchFor(b,c))},this)},this))},this)},i.prototype.getValue=function(){return this.possibleArrays&&this.rebuildArrays(),this.callbackFunction.apply(this.context,this.arguments)},i.prototype.bind=function(a,b){var c=i.createBindFunction(a,b),d=this.onValueChanged(c,!0);return d.registerDisposable(c),d},i.prototype.onValueChanged=function(a,b){var c=this.addCallback(a);return b&&a(void 0,this.val),c},i.stripFunction=function(a){a=a.toString().replace(d,"").replace(f,"");for(var b=/["']/g;b.exec(a);){var c="'"===a[b.lastIndex-1]?/'/g:/"/g;for(c.lastIndex=b.lastIndex;c.exec(a);){for(var e=0,g=c.lastIndex-2;"\\"===a[g];g--)e++;if(e%2===0){a=a.substr(0,b.lastIndex-1)+"#"+a.substr(c.lastIndex);break}}}return a},i.prototype.examineVariable=function(a,b){if(a=j(a),!/^[\$\w]+$/.test(a))throw"Invalid variable name. Variable names can only contain 0-9, a-z, A-Z, _ and $";for(var c,d,e,f,h=[],i=a.replace("$","\\$"),k=new RegExp((b?"(":"")+i+g+(b?")|"+i:""),"g"),l=[];null!==(c=k.exec(this.callbackString));)if(e=k.lastIndex-c[0].length,-1===(f=l.indexOf(d=c[0].replace(/\s/g,"")))||b){if(e>0){if(-1!==this.callbackString[e-1].search(/[\w\$]/))continue;for(var m=e-1;m>=0;m--){if("."===this.callbackString[m]){d=null;break}if(0!==this.callbackString[m].search(/\s/))break}}null!==d&&(-1===f&&(l.push(d),f=h.length,h.push({variableName:d,complexResults:[]})),b&&h[f].complexResults.push({name:c[0],index:e}))}return h},i.prototype.watchVariable=function(a,b,d){var f,g,h=this.examineVariable(a,d);e(h,function(a){if(f=c.utils.obj.splitPropertyName(a.variableName),f.length>1&&this.addPathWatchFor(b,c.utils.obj.joinPropertyName(f.slice(1))),d){var h;e(a.complexResults,function(a){(g=this.examineArrayProperties(a.name,a.index))&&(h?h.subPaths.push(g):this.possibleArrays.push(h={root:b,path:c.utils.obj.joinPropertyName(f.slice(1)),subPaths:[g]}))},this)}},this)};var k=new RegExp("^\\s*\\[\\s*[\\w\\$]+\\s*\\]\\s*"+g);return i.prototype.examineArrayProperties=function(a,b){var c;return(c=k.exec(this.callbackString.substr(b+a.length)))?(c=c[0].substr(c[0].indexOf("]")+1).replace(/\s/g,""),"."===c[0]?c.substring(1):c):void 0},i.prototype.addPathWatchFor=function(a,b){var d,b=new c.observeTypes.pathObserver(a,b,this.execute,this),e=this.execute.bind(this);return b.onValueChanged(function(a,b){d&&(d.dispose(),d=null),b instanceof c.array&&(d=b.observe(e))},!0),this.registerDisposable(b)},i.createBindFunction=function(a,b){var d,e=function(f,g){var h=c.utils.obj.getObject(b,a);g!==h&&(e.dispose(),g instanceof Array||h instanceof Array?d=c.tryBindArrays(g,h):c.utils.obj.setObject(b,a,g))};return e.dispose=function(){d&&(d.dispose(),d=null)},e},i}),g("busybody.observeTypes.pathObserver",function(){var a=c.observeTypes.observeTypesBase.extend(function(a,b,d,e){this._super(),this.forObject=a,this.property=b,this.path=c.utils.obj.splitPropertyName(b),this.__pathDisposables=new Array(this.path.length),this.execute(),this.buildObservableChain(),d&&this.onValueChanged(d.bind(e||a),!1)});return a.prototype.onValueChanged=function(a,b){var c=this.addCallback(a);return b&&a(void 0,this.val),c},a.prototype.buildObservableChain=function(a){a=a||0;for(var b=a;b<this.path.length;b++)this.__pathDisposables[b]&&(this.__pathDisposables[b].dispose(),this.__pathDisposables[b]=null);var d=this.forObject,e=this;for(b=0;d&&a>b;b++)d=d[this.path[b]];for(;d&&b<this.path.length-1;b++){if(c.canObserve(d)||d instanceof c.array){var f=[d,function(a){return function(){e.buildObservableChain(a),e.execute()}}(b)];isNaN(this.path[b])&&f.splice(1,0,this.path[b]),this.__pathDisposables[b]=c.tryObserve.apply(null,f)}d=d[this.path[b]]}c.canObserve(d)&&(this.__pathDisposables[b]=c.tryObserve(d,this.path[b],function(){this.execute()},this))},a.prototype.getValue=function(){for(var a=this.forObject,b=0,c=this.path.length;null!=a&&c>b;b++)a=a[this.path[b]];return b===c?a:null},a.prototype.dispose=function(){this._super();for(var a=0,b=this.__pathDisposables.length;b>a&&this.__pathDisposables[a];a++)this.__pathDisposables[a]&&this.__pathDisposables[a].dispose();this.__pathDisposables.length=0},a}),g("busybody.utils.compiledArrayChange",function(){function a(a,b,c){this.beginAt=b,this.endAt=c,this.changes=[],this.build(a)}return a.prototype.buildIndexes=function(){if(!this.indexes){var a,b,c=[],d=[],f=[],g=[],h=[],i=[],j=this.added.slice();e(this.finalArray,function(b,c){(c>=this.beginArray.length||b!==this.beginArray[c])&&(-1!==(a=j.indexOf(b))?(g.push({value:b,index:c}),j.splice(a,1)):f[c]=b)},this);var k=this.removed.slice();e(this.beginArray,function(b,e){(e>=this.finalArray.length||b!==this.finalArray[e])&&(-1!==(a=k.indexOf(b))?(h.push({value:b,index:e}),k.splice(a,1)):(c.push(b),d.push(e)))},this);for(var l={};c.length;)a=c.shift(),b=f.indexOf(a),f[b]=l,i.push({value:a,from:d.shift(),to:b});this.indexes={moved:i,added:g,removed:h}}},a.prototype.build=function(a){if(this.removed=[],this.added=[],!a.length||this.beginAt>=this.endAt)return void(this.indexes={added:[],removed:[],moved:[]});for(var b,c,d,f,g=a[0].object.slice(),h=a.length-1;h>=this.beginAt;h--)b="splice"===a[h].type?a[h]:{addedCount:1,index:parseInt(a[h].name),removed:[a[h].oldValue]},h<this.endAt&&(this.finalArray||(this.finalArray=g.slice()),f=0,e(b.removed,function(a){-1===(d=this.added.indexOf(a))?(this.removed.splice(f,0,a),f++):this.added.splice(d,1)},this),f=0,e(g.slice(b.index,b.index+b.addedCount),function(a){-1===(d=this.removed.indexOf(a))?(this.added.splice(f,0,a),f++):this.removed.splice(d,1)},this),this.changes.splice(0,0,{index:b.index,added:g.slice(b.index,b.index+b.addedCount),removed:b.removed,change:a[h]})),c=b.removed.slice(),c.splice(0,0,b.index,b.addedCount),g.splice.apply(g,c);this.beginArray=g.slice()},a.prototype.areEqual=function(a,b){return this.beginAt===a&&this.endAt===b},a.prototype.getRemoved=function(){return this.removed.slice()},a.prototype.getAdded=function(){return this.added.slice()},a.prototype.getIndexes=function(){return this.indexes||this.buildIndexes(),{added:this.indexes.added.slice(),removed:this.indexes.removed.slice(),moved:this.indexes.moved.slice()}},a}),g("busybody.utils.observeCycleHandler",function(){function a(a){a()}var b=c.observable.extend(function(){this._super(),this.$afterObserveCycles=[],this.$beforeObserveCycles=[],this.length=0,this.observe("length",function(b,c){0===c&&e(this.$afterObserveCycles.slice(),a)},this,{evaluateOnEachChange:!1,evaluateIfValueHasNotChanged:!0})});return b.prototype.execute=function(a,b){try{this.before(a),b()}finally{this.after(a)}},b.prototype.before=function(b){b!==this&&(0===this.length&&e(this.$beforeObserveCycles.slice(),a),this.length++)},b.prototype.clear=function(){this.length>0&&(this.length=0)},b.prototype.after=function(a){a===this||this.length<=0||this.length--},b.prototype.afterObserveCycle=function(a){return c.utils.obj.addWithDispose(this.$afterObserveCycles,a)},b.prototype.beforeObserveCycle=function(a){return c.utils.obj.addWithDispose(this.$beforeObserveCycles,a)},b.prototype.dispose=function(){this._super(),this.$afterObserveCycles.length=0,this.$beforeObserveCycles.length=0},b.instance=new b,b}),c.getObserver=function(a){return null==a||a instanceof c.observableBase?a:a.$observer instanceof c.observableBase?a.$observer:null},c.captureArrayChanges=function(a,b,d){if(!(a instanceof c.array))throw"Only busybody.array objects can have changes captured";return a.captureArrayChanges(b,d)},c.captureChanges=function(a,b,d,e){return(a=c.getObserver(a))?a.captureChanges(b,d,e):void b()},c.makeObservable=function(a){if(arguments.length||(a={}),a instanceof c.array){if(c.getObserver(a))return a}else if(c.canObserve(a))return a;if(a.$observer)throw"The $observer property is reserved";return Object.defineProperty(a,"$observer",{enumerable:!1,configurable:!1,value:new c.observable(a),writable:!1}),a},c.observe=function(a,b,d,e,f){return c.makeObservable(a),c.tryObserve(a,b,d,e,f)},c.tryObserve=function(a,b,d,e,f){if(a instanceof c.array){if(b instanceof Function)return a.observe(arguments[1],arguments[2],arguments[3]);"length"===b&&(b="$length"),c.makeObservable(a)}var g=c.getObserver(a);return g?g.observe(b,d,e,f):!1},c.computed=function(a,b,d,e){return c.getObserver(c.makeObservable(a)).computed(b,d,e)},c.observeArray=function(a,b,d,e,f){return c.makeObservable(a),c.tryObserveArray(a,b,d,e,f)},c.tryObserveArray=function(a,b,d,e,f){var g=c.getObserver(a);return g?g.observeArray(b,d,e,f):!1},c.tryBindArrays=function(a,b,d){if(!(a instanceof Array)&&null!=a||!(b instanceof Array)&&null!=b)throw"You cannot bind a value to an array. Arrays can only be bound to other arrays.";if(null!=a||null!=b){var e;if(null==a?b.length=0:null!=b&&(a instanceof c.array?e=a.bind(b):c.array.copyAll(a,b)),d){var f=c.tryBindArrays(b,a);f&&(e?e.registerDisposable(f):e=f)}return e}};var k=function(){var a=0;return function(){return"ch-"+ ++a}}();c.tryBind=function(a,d,e,f,g,h){function i(){j&&(l.disposseOf(j),disp=null);var g=c.utils.obj.getObject(d,a),i=c.utils.obj.getObject(f,e);g instanceof Array||i instanceof Array?j=l.registerDisposable(c.tryBindArrays(g,i)):h?h=void 0:(k||(k=b(a,d,e,f))).apply(this,arguments)}var j,k,l=new c.disposable;return l.registerDisposable(c.tryObserve(a,d,i,null,{useRawChanges:!0})),i(),g&&l.registerDisposable(c.tryBind(e,f,a,d,!1,!0)),l},c.bind=function(a,b,d,e,f){return c.makeObservable(a),c.makeObservable(d),c.tryBind(a,b,d,e,f)},c.canObserve=function(a){return a instanceof c.array||!!c.getObserver(a)},c.del=function(a,b){var d=c.getObserver(a);return d?d.del(b):void delete d[b]},c.dispose=function(a){var b=c.getObserver(a);return b?b.dispose():void 0},window.busybody=c}(window.orienteer);

}());

!function(a,b){function c(b,c){function d(){var a=[];return-1!==j&&(a[j]=k instanceof Function?k.apply(this,arguments):void 0!==k?k:arguments[0]),-1!==l&&(a[l]=m instanceof Function?m.apply(this,arguments):void 0!==m?m:arguments[1]),a}function e(){var a=[];for(var b in u){var c='"'+b.replace('"','\\"')+'"';a.push("\n	this.initComputed("+c+", computeds["+c+"].logic, computeds["+c+"].options);")}return a.join("")}function f(){if(g)throw'You cannot add any more functionality using this DSL as this view model has already been built. You can still add methods to the view model by adding them directly to the build output, e.g.\nvar myClass = wo.viewModel("myClass").build();\nmyClass.doSomething = function () { ... };'}c=c||wipeout.viewModels.view;var g,i,j,k,l,m,n,o={},p=(i=c.toString().replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//gm,"")).slice(i.indexOf("(")+1,i.indexOf(")")).match(/([^\s,]+)/g)||[],q={statics:!0},r={},s={},t={},u={},v={build:function(){if(g)return g.prototype;if(wipeout.utils.obj.getObject(b))throw b+" already exists.";j=p.indexOf("templateId"),-1!==j&&(k=o.templateId,delete o[j]),l=p.indexOf("model"),-1!==j&&(m=o.model,delete o[l]);var f=b.split(".");g=new Function("extend","getParentConstructorArgs","values","computeds","return function "+f[f.length-1]+" (templateId, model) {\n	extend.apply(this, getParentConstructorArgs.apply(this, arguments));\n\n	for (var i in values)\n		this[i] = values[i] instanceof Function ?\n			values[i].apply(this, arguments) :\n			values[i];\n"+e()+"}")(c,d,o,u),h(b,function(){return a.extend.call(c,g)}),q.statics=g;for(var i in q)g.prototype[i]=q[i];for(var i in r)g[i]=r[i];for(var i in t)g.addGlobalParser(i,t[i]);for(var i in s)g.addGlobalBindingType(i,s[i]);return q=void 0,r=void 0,s=void 0,n=void 0,v.build()},method:function(a,b){if(f(),!(b instanceof Function))return v.value(a,b);if(q[a])throw"You have already added a function: "+a;return q[a]=b,v},computed:function(a,b,c){if(f(),o[a])throw"You have already added a value: "+a;if(u[a])throw"You have already added a value: "+a;return u[a]={logic:b,options:c},v},value:function(a,b){if(f(),"constructor"===a)return v.constructor(b);if(b instanceof Function)return v.method(a,b);if(o[a])throw"You have already added a value: "+a;if(u[a])throw"You have already added a computed: "+a;return o[a]=b,v},dynamicValue:function(a,b){if(f(),"constructor"===a)return v.constructor(b);if(!(b instanceof Function))throw"A dynamic value must be a function which returns the value.";if(o[a])throw"You have already added a value: "+a;if(u[a])throw"You have already added a computed: "+a;return o[a]=b,v},staticMethod:function(a,b){return v.staticValue(a,b)},staticValue:function(a,b){if(f(),r[a])throw"You have already added a static value: "+a;return r[a]=b,v},parser:function(b,d){if(f(),t[b])throw"A parser has already been set for this object";if(n=n||a.getInheritanceChain.apply(c),-1===n.indexOf(wipeout.base.bindable))throw"You must inherit from wipeout.base.bindable to use global parsers. Alternatively you can inherit from any view model, such as wo.view, wo.contentCOntrol, wo.itemsControl etc...";return t[b]=d,v},binding:function(b,d){if(f(),s[b])throw"A binding type has already been set for this object";if(n=n||a.getInheritanceChain(c),-1===n.indexOf(wipeout.base.bindable))throw"You must inherit from wipeout.base.bindable to use global parsers. Alternatively you can inherit from any view model, such as wo.view, wo.contentCOntrol, wo.itemsControl etc...";return s[b]=d,v},templateId:function(a,b){return b&&wipeout.template.engine.instance.compileTemplate(a,function(){}),v.value("templateId",a)},onInitialized:function(a){return v.method("onInitialized",a)},onModelChanged:function(a){return v.method("onModelChanged",a)},onRendered:function(a){return v.method("onRendered",a)},onUnrendered:function(a){return v.method("onUnrendered",a)},dispose:function(a){return v.method("dispose",a)},onApplicationInitialized:function(a){return v.method("onApplicationInitialized",a)}};return v}function d(a,b){if(!a||null==b)throw"Invalid input";if(wo[a])throw a+" is already taken!";wo[a]=b}window.wipeout={};var e=function(a){var b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return b.onreadystatechange=function(){b.readyState==XMLHttpRequest.DONE&&(200!=b.status&&0!=b.status||!a.success?a.error&&a.error(b):a.success(b))},b.open(a.type||"GET",a.url||document.location.href,void 0!==a.async?a.async:!0),b.send(),b},f=function(a,b,c){if(a){c=c||window;for(var d=0,e=a.length;e>d;d++)b.call(c,a[d],d)}},g=function(a,b,c){if(a&&(c=c||window,null!=a))for(var d in a)b.call(c,a[d],d)},h=function(a,b){var c=window;if(a=o(a),"wipeout"===a[0]&&(c=wipeout,a.splice(0,1),!a.length))throw'Cannot override the "wipeout" variable';for(var d=0,e=a.length-1;e>d;d++)c=c[a[d]]||(c[a[d]]={});return c[a[a.length-1]]=b()},i=function(a,b){return h("wipeout.template.rendering.htmlAttributes.wo-"+a,b),b=function(){return wipeout.template.rendering.htmlAttributes["wo-"+a]},wipeout.template.rendering.htmlAttributes["wo-"+a].test instanceof Function&&h("wipeout.template.rendering.dynamicHtmlAttributes.wo-"+a,b),h("wipeout.template.rendering.htmlAttributes.data-wo-"+a,b)},j=/^\s+|\s+$/g,k=function(a){return a?a.replace(j,""):a},l=function(a){return a?k(a).toLowerCase():a},m=function(a){return null==a?!1:(a=l(a),!(!a||"false"===a||"0"===a))},n=function(a){if(!a)return a;for(var b,c=/\-/;-1!==(b=a.search(c));){if(b===a.length-1)return a.substr(0,b);a=a.substr(0,b)+a[b+1].toUpperCase()+a.substr(b+2)}return a},o=function(){var a=/\[\s*\d\s*\]$/g;return function(b){b=b.split(".");for(var c,d=0;d<b.length;d++){b[d]=k(b[d]);var e=b[d].match(a);if(e&&e.length){(c=k(b[d].replace(a,"")))?b[d]=k(b[d].replace(a,"")):(b.splice(d,1),d--);for(var f=0,g=e.length;g>f;f++)b.splice(++d,0,parseInt(e[f].match(/\d/)[0]))}}return b}}();h("wipeout.utils.obj",function(){var a=function(a){var b=[];return f(a,function(a){b.push(isNaN(a)?0===b.length?a:"."+a:"["+a+"]")}),b.join("")},b=function(a,b){return c(o(a),b)},c=function(a,b){b||(b=window);for(var c=0,d=a.length;d>c;c++)if(b=b[a[c]],null==b)return c===d-1?b:null;return b},d=function(a,b,d){return a=o(a),a.length>1&&(b=c(a.splice(0,a.length-1),b)),b?b[a[0]]=d:void 0},h=function(a){if(a instanceof Array)return a.slice();for(var b=[],c=0,d=a.length;d>c;c++)b.push(a[c]);return b},i=function(a){return Math.floor(Math.random()*a)},j=function(a,b){if(b&&a)for(var c in b)a[c]=b[c];return a},p=function(){};return p.extend=j,p.camelCase=n,p.ajax=e,p.parseBool=m,p.trimToLower=l,p.trim=k,p.enumerateArr=f,p.enumerateObj=g,p.getObject=b,p.setObject=d,p.splitPropertyName=o,p.joinPropertyName=a,p.copyArray=h,p.random=i,p}),h("wipeout.settings",function(){function a(a){g(wipeout.settings,function(a,b){delete wipeout.settings[b]}),g(a,function(a,b){wipeout.settings[b]=a})}return a.asynchronousTemplates=!0,a.displayWarnings=!0,a.useElementClassName=!1,a.wipeoutAttributes={viewModelName:"wo-view-model"},a}),h("wipeout.htmlBindingTypes.viewModelId",function(){return function(a,c,d){var e=d.$this===a?d.$parent:d.$this;e instanceof wipeout.viewModels.view&&(e.templateItems[c.value()]=a);var f=wipeout.htmlBindingTypes.nb(a,c,d)||new b.disposable;return f.registerDisposeCallback(function(){e instanceof wipeout.viewModels.view&&e.templateItems[c.value()]===a&&delete e.templateItems[c.value()]}),f}}),h("wipeout.template.initialization.parsers",function(){function a(){}return a.json=function(a,b,c){return JSON.parse(a)},a.string=function(a,b,c){return a},a.bool=function(a,b,c){var d=l(a);return d?"false"!==d&&"0"!==d:!1},a["int"]=function(a,b,c){return parseInt(k(a))},a["float"]=function(a,b,c){return parseFloat(k(a))},a.regexp=function(a,b,c){return new RegExp(k(a))},a.date=function(a,b,c){return new Date(k(a))},a.template=function(a){return a},a.template.useRawXmlValue=!0,a.j=a.json,a.s=a.string,a.b=a.bool,a.i=a["int"],a.f=a["float"],a.r=a.regexp,a.d=a.date,a}),h("wipeout.template.initialization.compiledInitializer",function(){function a(b){this.setters={},g(b.attributes,this.addAttribute,this),f(b,this.addElement,this),this.setters.model||(this.setters.model=a.modelSetter||(a.modelSetter=a.createPropertyValue("model",new wipeout.wml.wmlAttribute("$parent ? $parent.model : null"))))}a.getPropertyFlags=function(a){var b=wipeout.template.rendering.compiledTemplate.getPropertyFlags(a);return b.name=wipeout.utils.obj.camelCase(b.name),b},a.prototype.addElement=function(b){if(1===b.nodeType){var c=wipeout.utils.viewModels.getElementName(b);if(c=a.getPropertyFlags(c).name,this.setters.hasOwnProperty(c))throw'The property "'+c+'" has been set more than once.';for(var d in b.attributes)if("value"===d||0===d.indexOf("value--"))return f(b,function(a){if(3!==a.nodeType||!a.serialize().match(/^\s*$/))throw"You cannot set the value both in attributes and with elements."}),void(this.setters[c]=a.createPropertyValue(c,b.attributes[d],a.getPropertyFlags(d).flags));var e=b.attributes.parser||b.attributes.parsers;if(!e&&b._parentElement&&b._parentElement.name){var g=wipeout.utils.obj.getObject(wipeout.utils.obj.camelCase(b._parentElement.name));g&&g.getGlobalParser&&(e=g.getGlobalParser(c))}if(!e)for(var h=0,i=b.length;i>h;h++)if(1===b[h].nodeType){var j=wipeout.utils.viewModels.getViewModelConstructor(b[h]);if(!j)throw'Cannot create an instance of element: "'+b[h].name+'"';return void(this.setters[c]=a.createPropertyValue(c,{xml:b[h],constructor:j.constructor},["templateElementSetter"]))}e&&e.constructor===Function?(this.setters[c]=a.createPropertyValue(c,b),this.setters[c].parser=e):e?this.setters[c]=a.createPropertyValue(c,b,a.getPropertyFlags("--"+e.value).flags):this.setters[c]=a.createPropertyValue(c,b)}};var b="$wipeout_binding_type";return a.createPropertyValue=function(a,c,d){var e,f;if(d)for(var g=0,h=d.length;h>g;g++)if(wipeout.htmlBindingTypes[d[g]]){if(f)throw"The binding type has already been set for this element";f=d[g]}else if(wipeout.template.initialization.parsers[d[g]]){if(e)throw"The parser has already been set for this element";e=d[g]}var i=new wipeout.template.initialization.viewModelPropertyValue(a,c,e);return i[b]=f,i},a.prototype.addAttribute=function(b,c){if(c=a.getPropertyFlags(c),this.setters[c.name])throw'The property "'+c.name+'" has been set more than once.';this.setters[c.name]=a.createPropertyValue(c.name,b,c.flags)},a.prototype.initialize=function(b,c){var d=this.setters.model===a.modelSetter&&null!=b.model?[]:this.applyToViewModel("model",b,c);for(var e in this.setters)"model"!==e&&d.push.apply(d,this.applyToViewModel(e,b,c));return function(){f(d.splice(0,d.length),function(a){a&&a.dispose()})}},a.prototype.applyToViewModel=function(b,c,d){if(!this.setters[b])return[];var e=a.getBindingType(this.setters[b],c);if(!wipeout.htmlBindingTypes[e])throw'Invalid binding type :"'+e+'" for property: "'+b+'".';var f=[];return f.push.apply(f,this.setters[b].prime(c,function(){var a=wipeout.htmlBindingTypes[e](c,this.setters[b],d);a&&a.dispose instanceof Function?f.push(a):a instanceof Function&&f.push({dispose:a})}.bind(this))),f},a.getBindingType=function(a,c){return a[b]||c instanceof wipeout.base.bindable&&c.getGlobalBindingType(a.name)||"ow"},a}),h("wipeout.utils.dictionary",function(){var b=a.extend(function(){this.__keyArray=[],this.__valueArray=[]});return b.prototype.add=function(a,b){var c=this.__keyArray.indexOf(a);return-1===c?(this.__keyArray.push(a),this.__valueArray.push(b)):this.__valueArray[c]=b,b},b.prototype.length=function(){return this.__keyArray.length},b.prototype.keys=function(){return this.keys_unsafe().slice()},b.prototype.keys_unsafe=function(){return this.__keyArray},b.prototype.remove=function(a){var b;return-1!==(b=this.__keyArray.indexOf(a))?(this.__valueArray.splice(b,1),this.__keyArray.splice(b,1),!0):!1},b.prototype.value=function(a){return this.__valueArray[this.__keyArray.indexOf(a)]},b}),h("wipeout.base.bindable",function(){var a=b.observable.extend(function(){this._super()}),c="__wipeoutGlobalParser_";a.addGlobalParser=function(a,b){if("string"==typeof b&&(b=wipeout.template.initialization.parsers[b]),!(b instanceof Function))throw"Invalid parser. Parsers must be either a string which points to wipeout parser, or a function which will parse the data";var d=c+a;if(this.prototype.hasOwnProperty(d)){if(this.prototype[d]===b)return;throw"A global parser has already been defined for this property"}this.prototype[d]=b},a.prototype.addGlobalParser=function(b,c){return a.addGlobalParser.apply(this.constructor,arguments)};var d="__wipeoutGlobalBinding_";return a.addGlobalBindingType=function(a,b){if("string"!=typeof b||!wipeout.htmlBindingTypes[b])throw"Invalid binding type. Binding types must be a string which points to wipeout binding type";var c=d+a;if(this.prototype.hasOwnProperty(c)){if(this.prototype[c]===b)return;throw"A global binding has already been defined for this property"}this.prototype[c]=b},a.prototype.addGlobalBindingType=function(b,c){return a.addGlobalBindingType.apply(this.constructor,arguments)},a.prototype.getGlobalParser=function(a){return this[c+a]},a.prototype.getGlobalBindingType=function(a){return this[d+a]},a.getGlobalParser=function(a){return this.prototype[c+a]},a.getGlobalBindingType=function(a){return this.prototype[d+a]},a}),h("wipeout.viewModels.view",function(){function a(a){a.execute()}var b=wipeout.base.bindable.extend(function(a,b){this._super(),this.shareParentScope=!1,this.templateItems={},this.templateId=a,this.observe("model",this._onModelChanged,this,{activateImmediately:!0}),this.model=null==b?null:b,this.$routedEventSubscriptions=[],this.$synchronusTemplateChange=new wipeout.events.event,this.$initComputeds=[]});return b.prototype.initComputed=function(a,b,c){c?c={delayExecution:!0}:c.delayExecution=!0;var d=this.computed(a,b,c);return d&&(this.$initComputeds||(this.$initComputeds=[])).push(d),d},b.addGlobalParser("id","string"),b.addGlobalBindingType("id","viewModelId"),b.prototype.getParent=function(){var a=this.getRenderContext();return a?a.$this===this?a.$parent:a.$this:null},b.prototype.getParents=function(){var a=this.getRenderContext();if(!a)return[];var b=a.$parents.slice();return a.$this!==this&&b.splice(0,0,a.$this),b},b.prototype.getRenderContext=function(){return this.$domRoot&&this.$domRoot.renderContext||null},b.prototype._onModelChanged=function(a,b){a!==b&&this.onModelChanged(b)},b.prototype.onModelChanged=function(a){if(this.disposeOf(this.$modelRoutedEventKey),this.$modelRoutedEventKey=null,a instanceof wipeout.events.routedEventModel){var b=a.__triggerRoutedEventOnVM.register(this._onModelRoutedEvent,this);this.$modelRoutedEventKey=this.registerDisposable(b)}},b.prototype._onModelRoutedEvent=function(a){if(!(a.routedEvent instanceof wipeout.events.routedEvent))throw"Invaid routed event";this.triggerRoutedEvent(a.routedEvent,a.eventArgs)},b.prototype.dispose=function(){this._super(),f(this.$routedEventSubscriptions.splice(0,this.$routedEventSubscriptions.length),function(a){a.dispose()})},b.prototype.synchronusTemplateChange=function(a){arguments.length&&(this.templateId=a),this.$synchronusTemplateChange.trigger()},b.visualGraph=function(a,b){throw"TODO"},b.prototype.onRendered=function(a,b){},b.prototype.onUnrendered=function(){},b.prototype.onApplicationInitialized=function(){},b.prototype.onInitialized=function(){f(this.$initComputeds,a),this.$initComputeds=null},b}),h("wipeout.events.routedEvent",function(){var a=function b(){return this instanceof b?void 0:new b};return a.prototype.trigger=function(a,b){a.triggerRoutedEvent(this,new wipeout.events.routedEventArgs(b,a))},a.prototype.unRegister=function(a,b,c){return b.unRegisterRoutedEvent(this,a,c)},a.prototype.register=function(a,b,c){return b.registerRoutedEvent(this,a,c)},a}),h("wipeout.events.routedEventArgs",function(){var a=function(a,b){this.handled=!1,this.data=a,this.originator=b};return a}),h("wipeout.events.routedEventRegistration",function(){var a=function(a){this.routedEvent=a,this.event=new wipeout.events.event};return a.prototype.dispose=function(){this.event.dispose()},a}),h("wipeout.template.rendering.renderedContent",function(){var a=b.disposable.extend(function(a,b,c){this._super(),b=wipeout.utils.obj.trim(b),this.parentRenderContext=c,this.openingTag=document.createComment(" "+b+" "),this.openingTag.wipeoutOpening=this,this.closingTag=document.createComment(" /"+b+" "),this.closingTag.wipeoutClosing=this,a.parentNode.insertBefore(this.openingTag,a),a.parentNode.insertBefore(this.closingTag,a),a.parentNode.removeChild(a)});return a.prototype.rename=function(a){this.openingTag.nodeValue=" "+a+" ",this.closingTag.nodeValue=" /"+a+" "},a.prototype.renderArray=function(a){this.asynchronous&&(this.asynchronous.cancel(),delete this.asynchronous),this.unRender();var c=new wipeout.template.rendering.renderedArray(a,this);this.disposeOfBindings=c.dispose.bind(c),a instanceof b.array&&c.registerDisposable(a.observe(c.render,c,{useRawChanges:!0})),c.render([{type:"splice",addedCount:a.length,removed:[],index:0}])},a.prototype.render=function(a,b){return a instanceof Array?void this.renderArray(a):(this.unRender(),this.viewModel=a,void(null!=this.viewModel&&(this.renderContext=this.parentRenderContext?this.parentRenderContext.contextFor(this.viewModel,b):new wipeout.template.context(this.viewModel,null,b),this.viewModel instanceof wipeout.viewModels.view?(this.templateChangeKey=this.registerDisposable(this.viewModel.$synchronusTemplateChange.register(this.templateHasChanged,this)),this.viewModel.$domRoot=this,this.templateObserved=this.viewModel.observe("templateId",this._template,this,{activateImmediately:!0}),this.viewModel.templateId&&this.template(this.viewModel.templateId)):this.appendHtml(this.viewModel.toString()))))},a.prototype.templateHasChanged=function(){this.template(this.viewModel.templateId)},a.prototype._template=function(a,b){this.template(b)},a.prototype.unRender=function(a){this.unTemplate(a),this.templateObserved&&(this.templateObserved.dispose(),delete this.templateObserved),this.templateChangeKey&&(this.disposeOf(this.templateChangeKey),delete this.templateChangeKey),this.viewModel instanceof wipeout.viewModels.view&&delete this.viewModel.$domRoot,delete this.renderContext,delete this.viewModel},a.prototype.unTemplate=function(a){if(delete this.currentTemplate,this.disposeOfBindings&&(this.disposeOfBindings(),delete this.disposeOfBindings),!a)for(var b;(b=this.openingTag.nextSibling)&&b!==this.closingTag;)1===b.elementType&&(b.innerHTML=""),b.parentNode.removeChild(this.openingTag.nextSibling)},a.prototype.template=function(a){if(this.asynchronous&&this.asynchronous.cancel(),this.currentTemplate!==a&&(this.__initialTemplate&&this.unTemplate(),a&&(this.asynchronous=wipeout.template.engine.instance.compileTemplate(a,function(c){delete this.asynchronous,b&&(b.parentNode.removeChild(b),b=null),this.currentTemplate=a,this.disposeOfBindings=c.quickBuild(this.appendHtml.bind(this),this.renderContext),this.__initialTemplate=!0,this.viewModel.onRendered()}.bind(this)),this.asynchronous))){var b=wipeout.utils.html.createTemplatePlaceholder(this.viewModel);this.closingTag.parentNode.insertBefore(b,this.closingTag)}},a.prototype.dispose=function(a){this._super(),this.closingTag&&(this.unRender(a),a||this.detatched||(this.closingTag.parentNode.removeChild(this.closingTag),this.openingTag.parentNode.removeChild(this.openingTag)),delete this.detatched,delete this.closingTag.wipeoutClosing,delete this.openingTag.wipeoutOpening,delete this.closingTag,delete this.openingTag)},a.prototype.appendHtml=function(a){if(this.openingTag&&1===this.openingTag.nodeType)this.openingTag.insertAdjacentHTML("afterend",a);else{var b=document.createElement("script");this.closingTag.parentNode.insertBefore(b,this.closingTag),b.insertAdjacentHTML("afterend",a),b.parentNode.removeChild(b)}},a.getParentElement=function(a){for(var b=a.wipeoutClosing?a.wipeoutClosing.openingTag:a;b=b.previousSibling;)if(b.wipeoutClosing)b=b.wipeoutClosing.openingTag;else if(b.wipeoutOpening)return b;return a.parentNode},a}),h("wipeout.template.propertyValue",function(){var c=a.extend(function(a,b,c){if(this._super(),this.name=a,this._value=b,this.parser=null,c instanceof Function)this.parser=c;else if(c){if(!wipeout.template.initialization.parsers[c])throw"Invalid parser: "+c;this.parser=wipeout.template.initialization.parsers[c]}});return c.prototype.value=function(){return this._value},c.prototype.buildGetter=function(){if(!this._getter){var a,b=wipeout.utils.jsParse.removeCommentsTokenStringsAndBrackets(a=this.value()),c=b.output.split("=>");if(c.length>2)throw"Invalid attribute value: "+a+". You may only include 1 filter.";if(2===c.length){if(c[1]=k(c[1]),!wipeout.template.filters[c[1]])throw"Invalid filter: "+c[1];a=wipeout.template.filters[c[1]].parentToChild?'wipeout.template.filters["'+c[1]+'"].parentToChild('+c[0]+")":c[0].split(",")[0]}this._getter=wipeout.template.context.buildGetter(b.addTokens(a))}return this._getter},c.prototype.get=function(a,b){var c=this.getParser(b);return c?c(c.useRawXmlValue?this._value:this.value(),this.name,a):this.buildGetter().apply(null,a.asGetterArgs())},c.prototype.buildSetter=function(){if(!this.hasOwnProperty("_setter")){var a,b,c=wipeout.utils.jsParse.removeCommentsTokenStringsAndBrackets(a=this.value()),d=c.output.split("=>");if(d.length>2)throw"Invalid attribute value: "+a+". You may only include 1 filter.";if(2===d.length){if(d[1]=k(d[1]),!wipeout.template.filters[d[1]])throw"Invalid filter: "+d[1];wipeout.template.filters[d[1]].childToParent?(b='wipeout.template.filters["'+d[1]+'"].childToParent',d=d[0].split(/\s*\,\s*/),a=c.addTokens(d[0]),d[0]="arguments[5]",b+="("+d.join(", ")+")"):a=c.addTokens(d[0].split(",")[0])}var e=/\.\s*[\w\$]+\s*$/.exec(a);if(e){var f=wipeout.template.context.buildGetter(a.substring(0,a.length-e[0].length));e=e[0].replace(/(^\s*\.+\s*)|(\s*$)/,""),b?(b=wipeout.template.context.buildGetter(c.addTokens(b)),this._setter=function(a,c){var d=a.asGetterArgs().slice(),g=f.apply(null,d);return d.push(c),g?(g[e]=b.apply(null,d),!0):!1}):this._setter=function(a,b){var c=f.apply(null,a.asGetterArgs());return c?(c[e]=b,!0):!1}}else this._setter=null}return this._setter},c.prototype.canSet=function(a){return!this.getParser(a)&&!!this.buildSetter()},c.prototype.getParser=function(a){return a||(this.primed(),a=this.propertyOwner),this.parser||a instanceof wipeout.base.bindable&&a.getGlobalParser(this.name)},c.prototype.set=function(a,b,c){if(!this.canSet(c))throw"You cannot set the value of: "+this.value()+".";return this.buildSetter()(a,b)},c.prototype.watch=function(a,c,d){if(this.primed(),this.getParser()||/^\s*((true)|(false)|(\d+(\.\d+)?)|(\/(?!\/)))\s*$/.test(this.value()))return void(d&&c(void 0,this.get(a)));var e=/^([\$\w\s\.]|(\[\d+\]))+$/.test(this.value())?new b.observeTypes.pathObserver(a,this.value().replace(/^\s*\$model\./,"$this.model.")):a.getComputed(this.buildGetter());return this._caching.push(e),e.onValueChanged(c,d)},c.prototype.prime=function(a,b){if(this._caching)throw"prime cannot be asynchronus or nested.";try{return this._caching=[],this.propertyOwner=a,b(),this._caching}finally{delete this._caching,delete this.propertyOwner}},c.prototype.primed=function(){if(!this._caching)throw'The setter must be primed to make this call. Use the "prime(...)" function and pass in the logic to execute in a primed context.'},c}),h("wipeout.debug",function(){return{renderedItems:function(a,b){var c,d=[],e=function(a){if(a)switch(a.nodeType){case 1:f(a.childNodes,e);case 8:!(c=wipeout.utils.html.getViewModel(a))||-1!==d.indexOf(c)||b&&c.constructor!==b||d.push(c)}};return e(a||document.getElementsByTagName("body")[0]),d}}}),h("wipeout.events.eventRegistration",function(){return b.disposable.extend(function(a,b,c){this._super(),this.callback=a,this.context=b,this.registerDisposeCallback(c)})}),h("wipeout.events.event",function(){var a=function b(){return this instanceof b?void(this._registrations=[]):new b};return a.prototype.trigger=function(a){for(var b=0,c=this._registrations.length;c>b;b++){if(a instanceof wipeout.events.routedEventArgs&&a.handled)return;this._registrations[b].callback.call(this._registrations[b].context,a)}},a.prototype.unRegister=function(a,b){b=null==b?window:b;for(var c=0;c<this._registrations.length;c++)this._registrations[c].callback===a&&this._registrations[c].context===b&&(this._registrations.splice(c,1),c--)},a.prototype.dispose=function(){this._registrations.length=0},a.prototype.register=function(a,b,c){if(!(a instanceof Function))throw"Invalid event callback";if(c&&!(c instanceof Number))throw"Invalid event priority";for(var d=this._registrations,e={priority:c||0,callback:a,context:null==b?window:b,dispose:function(){if(e){var a=d.indexOf(e);a>=0&&d.splice(a,1),e=null}}},f=0,g=this._registrations.length;g>f;f++)if(e.priority<this._registrations[f].priority){this._registrations.splice(f,0,e);break}return f===g&&this._registrations.push(e),new wipeout.events.eventRegistration(e.callback,e.context,e.dispose,e.priority)},a}),h("wipeout.events.routedEventModel",function(){var b=a.extend(function(){this._super(),this.__triggerRoutedEventOnVM=new wipeout.events.event,this.__routedEventSubscriptions=[]});return b.prototype.triggerRoutedEvent=function(a,b){this.__triggerRoutedEventOnVM.trigger({routedEvent:a,eventArgs:b})},b.prototype.routedEventTriggered=function(a,b){for(var c=0,d=this.__routedEventSubscriptions.length;d>c;c++){if(b.handled)return;this.__routedEventSubscriptions[c].routedEvent===a&&this.__routedEventSubscriptions[c].event.trigger(b)}},b.prototype.registerRoutedEvent=function(a,b,c,d){for(var e,f=0,g=this.__routedEventSubscriptions.length;g>f;f++)if(this.__routedEventSubscriptions[f].routedEvent===a){e=this.__routedEventSubscriptions[f];break}return e||(e=new wipeout.events.routedEventRegistration(a),this.__routedEventSubscriptions.push(e)),e.event.register(b,c,d)},b.prototype.unRegisterRoutedEvent=function(a,b,c){for(var d=0,e=this.__routedEventSubscriptions.length;e>d;d++)if(this.__routedEventSubscriptions[d].routedEvent===a)return this.__routedEventSubscriptions[d].event.unRegister(b,c),!0;return!1},b}),h("wipeout.htmlBindingTypes.nb",function(){return function(a,b,c){a[b.name]=b.get(c)}}),h("wipeout.htmlBindingTypes.ow",function(){return function(a,b,c){b.watch(c,function(c,d){a[b.name]=d},!0)}}),h("wipeout.htmlBindingTypes.owts",function(){return function(a,b,c){if(!b.canSet())throw'Setter "'+b.value()+'" cannot be set.';b.onPropertyChanged(function(d,e){b.set(c,e,a)},!0)}}),h("wipeout.htmlBindingTypes.setTemplateToTemplateId",function(){return function(a,b,c){a.templateId=wipeout.viewModels.contentControl.createAnonymousTemplate(b._value)}}),h("wipeout.htmlBindingTypes.templateElementSetter",function(){return function(a,c,d){a[c.name]=new c._value.constructor;var e=new b.disposable(wipeout.template.engine.instance.getVmInitializer(c._value.xml).initialize(a[c.name],d));return a[c.name].dispose instanceof Function&&e.registerDisposable(a[c.name]),e}}),h("wipeout.htmlBindingTypes.templateProperty",function(){return function(a,b,c){a[b.name+"Id"]=wipeout.viewModels.contentControl.createAnonymousTemplate(b._value)}}),h("wipeout.htmlBindingTypes.tw",function(){return function(a,c,d){var e;if(c.getParser(a)||!/^([\$\w\s\.]|(\[\d+\]))+$/.test(e=c.value()))throw'Setter "'+e+'" must reference only one value when binding back to the source.';var f=b.utils.obj.splitPropertyName(e);return b.getObserver(d[f[0]])?(d=d[f[0]],e=b.utils.obj.joinPropertyName(f.slice(1))):"$parents"===f[0]&&d.$parents&&b.getObserver(d.$parents[f[1]])&&(d=d.$parents[f[1]],e=b.utils.obj.joinPropertyName(f.slice(2))),b.tryBind(d,e,a,c.name,!0)}}),h("wipeout.polyfills.Array",function(){var a=function(){};return a.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;d>c;c++)if(this[c]===a)return c;return-1},g(a.prototype,function(a,b){Array.prototype[b]||(Array.prototype[b]=a)}),a}),h("wipeout.polyfills.Function",function(){var a=function(){};return a.prototype.bind=function(a){var b=this;return function(){return b.apply(a,arguments)}},g(a.prototype,function(a,b){Function.prototype[b]||(Function.prototype[b]=a)}),a}),h("wipeout.profile.highlightVM",function(){var b=a.extend(function(a,b){this.vm=a,this.cssClass=b,this.nodes=a.entireViewModelHtml(),wipeout.utils.obj.enumerateArr(this.nodes,function(a){a.classList&&a.classList.add(this.cssClass)},this)});return b.prototype.dispose=function(){wipeout.utils.obj.enumerateArr(this.nodes,function(a){a.classList&&a.classList.remove(this.cssClass)},this)},b}),h("wipeout.profile.highlighter",function(){function a(){this.style=document.createElement("style"),this.index=0,this.styles=["wipeout-profiler-"+a.newId(),"wipeout-profiler-"+a.newId(),"wipeout-profiler-"+a.newId(),"wipeout-profiler-"+a.newId(),"wipeout-profiler-"+a.newId()];for(var b=0,c=this.styles.length;c>b;b++)this.style.innerHTML+=" ."+this.styles[b]+" {background-color:#"+a.generateColour()+" !important; cursor: pointer !important}";document.head.appendChild(this.style),this.currentHighlighter={dispose:function(){}};var d=this;this.eventHandler=function(a){d.highlightVM(a)},window.addEventListener("mousemove",this.eventHandler,!1)}return a.newId=function(){var a=0;return function(){return++a}}(),a.generateColour=function(){var a=Math.floor((wipeout.utils.obj.random(255)+255)/2),b=Math.floor((wipeout.utils.obj.random(255)+255)/2),c=Math.floor((wipeout.utils.obj.random(255)+255)/2);return a.toString(16)+b.toString(16)+c.toString(16)},a.prototype.nextStyle=function(){return this.index>=this.styles.length-1?this.index=0:this.index++,this.styles[this.index]},a.prototype.highlightVM=function(a){var b=document.elementFromPoint(a.clientX,a.clientY);if(b!==this.currentElement){this.currentElement=b;var c=wipeout.utils.html.getViewModel(this.currentElement);if(c&&c!==this.currentHighlighter.vm){var d=this.__timeoutToken={},e=this;setTimeout(function(){e.__timeoutToken===d&&(e.currentHighlighter.dispose(),e.currentHighlighter=new wipeout.profile.highlightVM(c,e.nextStyle()))},100)}}},a.prototype.dispose=function(){this.style.parentNode&&this.style.parentNode.removeChild(this.style),delete this.__timeoutToken,window.removeEventListener("mousemove",this.eventHandler),this.currentHighlighter.dispose()},a}),h("wipeout.profile.profile",function(){return function(){}}),h("wipeout.template.context",function(){function a(a,c,d){if(a&&a.shareParentScope)throw"You cannot create a template context for a view model with a shared parent scope";this.$this=a,c?(this.$parentContext=c,this.$parent=c.$this,this.$parents=[c.$this],this.$parents.push.apply(this.$parents,c.$parents)):(this.$parentContext=null,this.$parent=null,this.$parents=[]),null!=d&&(this.$index=new b.observable,this.$index.value=d)}function c(){}c.prototype=window,a.prototype=new c,a.prototype.find=function(a,b){return(this._finder||(this._finder=new wipeout.utils.find(this))).find(a,b)},a.prototype.contextFor=function(b,c){return wipeout.settings.displayWarnings&&b.shareParentScope&&null!=c&&console.warn("If an item in an array is to be rendered with shareParentScope set to true, this item will not have an $index value in it's renered context"),b&&b.shareParentScope?this:new a(b,this,c)},a.prototype.asGetterArgs=function(){return this.getterArgs||(this.getterArgs=[this,this.$this,this.$parent,this.$parents,this.$index])},a.prototype.asWatchVariables=function(){return this.watchVariables||(this.watchVariables={$context:this,$this:this.$this,$parent:this.$parent,$parents:this.$parents,$index:this.$index})},a.prototype.asEventArgs=function(a,b){var c=this.asGetterArgs().slice();return c.push(a),c.push(b),c},a.prototype.getComputed=function(a){return new b.observeTypes.computed(a,null,{watchVariables:this.asWatchVariables()})},a.buildGetter=function(a){try{var b=/\$model/.test(a)?"var $model = $this ? $this.model : null;\n":"";return new Function("$context","$this","$parent","$parents","$index",b+"return "+a+";");

}catch(c){throw"Invalid function logic. Function logic must contain only one line of code and must not have a 'return' statement "}};var d=/^\s*[Ll]ogic\s*:/;return a.buildEventCallback=function(a){d.test(a)?a=a.replace(d,""):/\)[\s;]*$/.test(a)||(a+="(e, element)");try{var b=/\$model/.test(a)?"var $model = $this ? $this.model : null;\n":"";return new Function("$context","$this","$parent","$parents","$index","e","element",b+a)}catch(c){throw"Invalid function logic. Function logic must contain only one line of code and must not have a 'return' statement "}},a}),h("wipeout.template.engine",function(){function a(){this.templates={},this.xmlIntializers=new wipeout.utils.dictionary}a.prototype.setTemplate=function(a,b){if(!a)throw"Invalid template id";return"string"==typeof b?b=wipeout.wml.wmlParser(b):2===b.nodeType&&(b=wipeout.wml.wmlParser(b.value)),this.templates[a]=new wipeout.template.rendering.compiledTemplate(b)},a.prototype.getTemplateXml=function(a,c){return a=b(a),this.compileTemplate(a,function(){c(this.templates[a].xml)}.bind(this))};var b=function(){var a;return function(b){return b||a||(a=wipeout.viewModels.contentControl.createAnonymousTemplate(""))}}();return a.prototype.compileTemplate=function(a,c){if(a=b(a),this.templates[a]instanceof wipeout.template.rendering.compiledTemplate)return c(this.templates[a]),null;if(this.templates[a]instanceof wipeout.template.loader)return this.templates[a].add(function(b){this.templates[a]instanceof wipeout.template.loader&&this.setTemplate(a,b),this.compileTemplate(a,c)}.bind(this));if(!this.templates[a]){var d;if(d=document.getElementById(a))return c(this.setTemplate(a,"script"===l(d.tagName)?d.text:d.innerHTML)),null;if(wipeout.settings.asynchronousTemplates)return this.templates[a]=new wipeout.template.loader(a),this.compileTemplate(a,c)}throw'Could not load template "'+a+'".'},a.prototype.getVmInitializer=function(a){var b;return(b=this.xmlIntializers.value(a))?b:this.xmlIntializers.add(a,new wipeout.template.initialization.compiledInitializer(a))},a.instance=new a,a}),h("wipeout.template.filters",function(){return function(){}}),h("wipeout.template.initialization.viewModelPropertyValue",function(){var a=wipeout.template.propertyValue.extend(function(a,b,c){this._super(a,b,c)});return a.prototype.onPropertyChanged=function(a,c){this.primed();var d=b.tryObserve(this.propertyOwner,this.name,a);return d&&this._caching.push(d),c&&a(void 0,wipeout.utils.obj.getObject(this.name,this.propertyOwner)),!!d},a.prototype.value=function(){return this.hasOwnProperty("_valueAsString")?this._valueAsString:this._valueAsString=this._super().serializeContent()},a}),h("wipeout.template.loader",function(){function a(a){this._callbacks=[],this.templateName=a,wipeout.utils.obj.ajax({type:"GET",url:a,success:function(a){this._success=!0;var b=this._callbacks;delete this._callbacks,this.templateValue=a.responseText;for(var c=0,d=b.length;d>c;c++)b[c](this.templateValue)}.bind(this),error:function(){throw delete this._callbacks,this._success=!1,'Could not locate template "'+a+'"'}.bind(this)})}return a.prototype.add=function(a){if(this._callbacks)return this._callbacks.push(a),{cancel:function(){var b;this._callbacks&&-1!==(b=this._callbacks.indexOf(a))&&this._callbacks.splice(b,1)}.bind(this)};if(this._success)return a(this.templateValue),null;throw'Could not load template "'+this.templateName+'"'},a}),h("wipeout.template.rendering.builder",function(){function a(b){this.elements=[];var c=[];f(b.html,function(b){if("string"==typeof b)c.push(b);else{var d=a.uniqueIdGenerator();c.push(' id="'+d+'"'),this.elements.push({id:d,actions:b})}},this),this.html=c.join("")}var b="wipeout_placeholder_id_";return a.uniqueIdGenerator=function(){var a=Math.floor(1e9*Math.random());return function(){return b+ ++a}}(),a.applyToElement=function(a,b,c){var d=[];return d.push.apply(d,a.prime(b,function(){var e=wipeout.template.rendering.htmlAttributes[a.action||a.name](b,a,c);e&&e.dispose instanceof Function?d.push(e):e instanceof Function&&d.push({dispose:e})})),d},a.prototype.execute=function(b){var c=[];return f(this.elements,function(d){var e=document.getElementById(d.id);e.removeAttribute("id"),f(d.actions,function(d){c.push.apply(c,a.applyToElement(d,e,b))})},this),function(){f(c.splice(0,c.length),function(a){a.dispose()})}},a}),h("wipeout.template.rendering.compiledTemplate",function(){function a(a){this.xml=a,this.html=[],this._addedElements=[],f(a,this.addNode,this);for(var b=this.html.length-1;b>0;b--)"string"==typeof this.html[b]&&"string"==typeof this.html[b-1]&&(this.html[b-1]+=this.html.splice(b,1)[0]);delete this._addedElements}a.getPropertyFlags=function(a){var b=a.indexOf("--");return-1===b?{flags:[],name:a}:{flags:a.substr(b+2).toLowerCase().split("-"),name:a.substr(0,b)}},a.prototype.addNonElement=function(a){this.html.push(a.serialize())};var b="{{",c="}}";return a.renderParenthesis=function(a,d){b=a,c=d},a.prototype.addTextNode=function(a){for(var d=a.serialize(),e=0,f=0;-1!==(f=d.indexOf(b,e));){if(this.html.push(d.substring(e,f)),e=f+b.length,-1===(f=d.indexOf(c,e)))throw"TODE";this.html.push("<script"),this.html.push([new wipeout.template.rendering.htmlPropertyValue("wo-render",d.substring(e,f))]),this.html.push(' type="placeholder"></script>'),e=f+b.length}this.html.push(d.substr(e))},a.prototype.addViewModel=function(a){this.html.push("<script"),this.html.push([new wipeout.template.rendering.htmlPropertyValue("wipeoutCreateViewModel",a)]),this.html.push(' type="placeholder"></script>')},a.getAttributeName=function(a){if(wipeout.template.rendering.htmlAttributes[a])return a;for(var b in wipeout.template.rendering.dynamicHtmlAttributes)if(wipeout.template.rendering.dynamicHtmlAttributes[b].test(a))return b},a.prototype.addAttributes=function(b){var c,d;g(b,function(b,e){var f=a.getPropertyFlags(e);if(e=f.name,f=f.flags,d=!1,d=a.getAttributeName(e)){c||this.html.push(c=[]);for(var g,h=0,i=f.length;i>h;h++)if(wipeout.template.initialization.parsers[f[h]]){if(g)throw"The parser has already been set for this element";g=f[h]}d!==e?c.push(new wipeout.template.rendering.htmlPropertyValue(e,b.value,g,d)):"id"===e?c.splice(0,0,new wipeout.template.rendering.htmlPropertyValue(e,b.value,g)):c.push(new wipeout.template.rendering.htmlPropertyValue(e,b.value,g))}else this.html.push(" "+e+b.serializeValue())},this)},a.prototype.addElement=function(a){this.html.push("<"+a.name),this.addAttributes(a.attributes),a.inline?this.html.push(" />"):(this.html.push(">"),f(a,function(a){this.addNode(a)},this),this.html.push("</"+a.name+">"))},a.prototype.addNode=function(a){if(-1!==this._addedElements.indexOf(a))throw"Infinite loop";this._addedElements.push(a),3===a.nodeType?this.addTextNode(a):1!==a.nodeType?this.addNonElement(a):wipeout.utils.viewModels.getViewModelConstructor(a)?this.addViewModel(a):this.addElement(a)},a.prototype.quickBuild=function(a,b){var c=this._builder||(this._builder=this.getBuilder());return a(c.html),c.execute(b)},a.prototype.getBuilder=function(){return new wipeout.template.rendering.builder(this)},a}),i("attr",function(){function a(a,c,d){if(b(c.name)){var e=c.name.substr(c.name.indexOf("attr-")+5);c.watch(d,function(b,c){a.getAttribute(e)!==c&&a.setAttribute(e,c)},!0)}}var b=a.test=function(a){return/^\s*(data\-)?wo\-attr\-./.test(a)};return a}),i("class",function(){function a(a,b,c){var d,h=b.name.substr(b.name.indexOf("class-")+6);!(d=e(a,h))&&b.get(c)?f(a,h):d&&!b.get(c)&&g(a,h),b.watch(c,function(b,c){!b&&c?f(a,h):b&&!c&&g(a,h)},!1)}function b(b,d,e){if(c(d.name)){if(wipeout.settings.useElementClassName||!b.classList)return a(b,d,e);var f=d.name.substr(d.name.indexOf("class-")+6);d.get(e)?b.classList.add(f):b.classList.remove(f),d.watch(e,function(a,c){c?b.classList.add(f):b.classList.remove(f)},!1)}}var c=b.test=function(a){return/^\s*(data\-)?wo\-class\-./.test(a)},d=function(a){return new RegExp("(?:^|\\s)"+a+"(?!\\S)","g")},e=function(a,b){return d(b).test(a.className)},f=function(a,b){e(a,b)||(a.className=k(a.className+(a.className.length?" ":"")+b))},g=function(a,b){var c;(c=d(b)).test(a.className)&&(a.className=k(a.className.replace(c,"")))};return b}),i("content",function(){return function(a,b,c){b.watch(c,function(b,c){a.innerHTML=null==c?"":c},!0)}}),i("data",function(){return function(a,b,c){b.setData(a,"wo-data",b)}}),i("event",function(){function a(a,c,d){b(c.name)&&c.onElementEvent(c.name.substr(c.name.indexOf("event-")+6),d)}var b=a.test=function(a){return/^\s*(data\-)?wo\-event\-./.test(a)};return a}),f(["blur","change","click","focus","keydown","keypress","keyup","mousedown","mouseout","mouseover","mouseup","submit"],function(a){i(a,function(){return function(b,c,d){c.onElementEvent(a,d)}})}),h("wipeout.template.rendering.htmlAttributes.id",function(){return function(a,b,c){var d=b.value();return c.$this instanceof wipeout.viewModels.view&&(c.$this.templateItems[d]=a),a.id=d,function(){c.$this instanceof wipeout.viewModels.view&&c.$this.templateItems[d]===a&&delete c.$this.templateItems[d]}}}),i("on-event",function(){return function(a,b,c){b.setData(a,"wo-on-event",b.value())}}),i("render",function(){return function a(b,c,d){if(1===b.nodeType&&"script"!==wipeout.utils.viewModels.getElementName(b))return b.innerHTML='<script type="placeholder"></script>',a(b.firstChild,c,d);var e=new wipeout.template.rendering.renderedContent(b,c.value(),d);return c.watch(d,function(a,b){e.render(b)},!0),e.dispose.bind(e)}}),i("style",function(){function a(a,c,d){if(b(c.name)){var e=c.name.substr(c.name.indexOf("style-")+6);c.watch(d,function(b,c){a.style[e]!=c&&(a.style[e]=c)},!0)}}var b=a.test=function(a){return/^\s*(data\-)?wo\-style\-./.test(a)};return a}),i("value",function(){function a(a,b,d){var e=b.value();if(!b.canSet())throw'Cannot bind to the property "'+e+'".';b.watch(d,function(e,f){f===c(a,b,d)?a.setAttribute("checked","checked"):a.removeAttribute("checked")},!0),b.onElementEvent("change",d,function(){b.set(d,c(a,b,d),a)})}function b(a,b,c){var d;return(d=b.getData(a,"wo-data"))?d.get(c,a):null!=(d=a.getAttribute("value"))?d:e}function c(a,c,d){var f=b(a,c,d);if(f===e)throw'Radio buttons with the "wo-value" attribute must have a "value" or "wo-data" attribute.';return f}function d(a,c,d){var f=c.value();if(!c.canSet())throw'Cannot bind to the property "'+f+'".';var g;(g=b(a,c,d))!==e&&c.set(d,g,a),c.watch(d,function(b,c){c||""===c?a.setAttribute("checked","checked"):a.removeAttribute("checked")},!0),c.onElementEvent("change",d,function(){g=b(a,c,d),null!=a.getAttribute("checked")?g===e&&(g=!0):g=g===e?!1:null,c.set(d,g,a)})}var e={};return function(b,c,e){if("checkbox"===b.type)return d(b,c,e);if("radio"===b.type)return a(b,c,e);var f=c.value();if(!c.canSet())throw'Cannot bind to the property "'+f+'".';var g="textarea"===l(b.tagName);c.watch(e,function(a,c){g&&b.innerHTML!==c?b.innerHTML=c:g||b.value===c||(b.value=c)},!0),c.onElementEvent(c.getData(b,"wo-on-event")||"change",e,function(){c.set(e,g?b.innerHTML:b.value,b)})}}),i("visible",function(){return function(a,b,c){a.style.display=b.get(c)?"":"none",b.watch(c,function(b,c){c&&!b?a.style.display="":!c&&b&&(a.style.display="none")},!1)}}),h("wipeout.template.rendering.htmlAttributes.wipeoutCreateViewModel",function(){return function(a,b,c){var d=new wipeout.template.rendering.viewModelElement(a,b.value(),c);return function(){d.dispose(!0)}}}),h("wipeout.template.rendering.htmlPropertyValue",function(){var a=wipeout.template.propertyValue.extend(function(a,b,c,d){this._super(a,b,c),this.action=d});return a.prototype.eventBuild=function(){return this._eventBuilt||(this._eventBuilt=wipeout.template.context.buildEventCallback(this.value()))},a.prototype.onElementEvent=function(a,c,d,e){this.primed();var f=this.propertyOwner;d=d||function(a){a.preventDefault(),this.eventBuild().apply(null,c.asEventArgs(a,f))}.bind(this),f.addEventListener(a,d,e||!1);var g=new b.disposable(function(){f.removeEventListener(a,d,e||!1),d=null});return this._caching.push(g),g.dispose.bind(g)},a.prototype.setData=function(a,b,c){return this.primed(),this._caching.push({dispose:function(){wipeout.utils.domData.clear(a,b)}}),wipeout.utils.domData.set(a,b,c)},a.prototype.getData=function(a,b){return wipeout.utils.domData.get(a,b)},a.prototype.dataExists=function(a,b){return wipeout.utils.domData.exists(a,b)},a}),h("wipeout.template.rendering.renderedArray",function(){var a=b.disposable.extend(function(a,b){if(this._super(),this.parent=b,this.array=a,this.parent.parentRenderContext&&this.parent.parentRenderContext.$this instanceof wipeout.viewModels.itemsControl&&a===this.parent.parentRenderContext.$this.items&&(this.itemsControl=this.parent.parentRenderContext.$this),this.children=[],this.itemsControl){if(this.itemsControl.$getChild)throw"These items are being rendered already.";this.itemsControl.$getChild=function(a){if(0===arguments.length){for(var b=this.children.slice(),a=0,c=b.length;c>a;a++)b[a]=b[a].renderedChild;return b}return this.children[a]?this.children[a].renderedChild:void 0}.bind(this)}});a.prototype.remove=function(a){this.itemsControl&&this.itemsControl.onItemRemoved(a.renderedChild),delete a.renderedChild,delete a.forItem,a.dispose()};var c={};return a.prototype.render=function(a){var b=[];f(a,function(a){if("splice"===a.type){for(var d=new Array(a.addedCount),e=0;e<a.addedCount;e++)d[e]=c;d.splice(0,0,a.index,a.removed.length),b.push.apply(b,this.children.slice(a.index,a.index+a.removed.length)),this.children.splice.apply(this.children,d)}else isNaN(parseInt(a.name))||(this.children[a.name]!==c&&b.push(this.children[a.name]),this.children[a.name]=c)},this);for(var d=b.length-1;d>=0;d--)b[d]===c&&b.splice(1,d);for(var e=0,g=this.children.length;g>e;e++)if(this.children[e]===c){for(var d=0,h=b.length;h>d;d++)if(b[d].forItem===this.array[e]){var i=b.splice(d,1)[0];0===e?this.parent.prepend(i):this.children[e-1].insertAfter(i),i.renderContext.$index.value=e,i.rename("item: "+e),this.children[e]=i;break}if(d==h){var j=document.createElement("script");0===e?this.parent.prepend(j):this.children[e-1].insertAfter(j),this.children[e]=new wipeout.template.rendering.renderedContent(j,"item: "+e,this.parent.parentRenderContext);var k=this.itemsControl?this.itemsControl._createItem(this.array[e]):this.array[e];this.children[e].render(k,e),this.children[e].forItem=this.array[e],this.itemsControl&&(this.children[e].renderedChild=k,this.itemsControl.onItemRendered(k))}}f(b,this.remove,this)},a.prototype.dispose=function(){this._super(),f(this.children,this.remove,this),this.children.length=0,this.itemsControl&&(delete this.itemsControl.$getChild,delete this.itemsControl),delete this.array},a}),function(){function a(a){try{return a instanceof b?a.detatch():a instanceof Array?a:[a]}finally{a instanceof b&&delete a.detatched}}var b=wipeout.template.rendering.renderedContent;b.prototype.prepend=function(b){b=a(b),b.push(this.openingTag.nextSibling||this.closingTag);for(var c=b.length-2;c>=0;c--)b[c+1].parentNode.insertBefore(b[c],b[c+1])},b.prototype.insertBefore=function(b){f(a(b),function(a){this.parentNode.insertBefore(a,this)},this.openingTag)},b.prototype.insertAfter=function(b){b=a(b),this.closingTag.nextSibling?this.closingTag.parentNode.insertBefore(b[b.length-1],this.closingTag.nextSibling):this.closingTag.parentNode.appendChild(b[b.length-1]);for(var c=b.length-2;c>=0;c--)b[c+1].parentNode.insertBefore(b[c],b[c+1])},b.prototype.detatch=function(){if(!this.detatched){var a=this.openingTag;this.detatched=[this.openingTag];for(var b=0;a&&a!==this.closingTag;b++)this.detatched.push(a=a.nextSibling),this.detatched[b].parentNode.removeChild(this.detatched[b])}return this.detatched.slice()},b.prototype.allHtml=function(){if(this.detatched)return this.detatch();for(var a=[this.openingTag],b=this.openingTag;b&&b!==this.closingTag;)a.push(b=b.nextSibling);return a}}(),h("wipeout.template.rendering.viewModelElement",function(){function a(){throw"A view model element can only be rendered once"}var c=wipeout.template.rendering.renderedContent.extend(function(b,c,d){var e=wipeout.utils.viewModels.getViewModelConstructor(c?c:b);if(!e)throw"Invalid view model";this._super(b,wipeout.utils.obj.trim(e.name),d),this.createdViewModel=new e.constructor,this.renderContext=d?d.contextFor(this.createdViewModel):new wipeout.template.context(this.createdViewModel),this.disposeOfViewModelBindings=wipeout.template.engine.instance.getVmInitializer(c||wipeout.wml.wmlParser(b)).initialize(this.createdViewModel,this.renderContext),this.createdViewModel instanceof wipeout.viewModels.view&&this.createdViewModel.onInitialized(),this.render(this.createdViewModel),this.render=a});return c.prototype.dispose=function(a){this._super(a),this.disposeOfViewModelBindings(),this.createdViewModel instanceof b.disposable?this.createdViewModel.dispose():b.dispose(this.createdViewModel),delete this.createdViewModel},c}),h("wipeout.utils.domData",function(){function a(){}var b="__wipeout_domData";return a.exists=function(a,c){return a[b]&&a[b].hasOwnProperty(c)},a.get=function(c,d){return arguments.length<2?c[b]:a.exists(c,d)?c[b][d]:void 0},a.set=function(a,c,d){return(a[b]||(a[b]={}))[c]=d},a.clear=function(a,c){if(c&&a[b])for(var d in a[b])if(d!==c)return void delete a[b][c];delete a[b]},a}),h("wipeout.utils.find",function(){var b=a.extend(function(a){this._super(),this.renderContext=a});return b.prototype.find=function(a,b){var c={};if(b)for(var d in b)c[d]=b[d];if(b=c,b.$number||(b.$number=0),a&&a.constructor===Function)b.$instanceOf=a;else if(a&&a.constructor!==String)for(var d in a)b[d]=a[d];else b.$ancestry=wipeout.utils.obj.trim(a);!b.$number&&b.$n&&(b.$number=b.$n),!b.$instanceOf&&b.$i&&(b.$instanceOf=b.$i),!b.$instanceOf&&b.$instanceof&&(b.$instanceOf=b.$instanceof),!b.$ancestry&&b.$a&&(b.$ancestry=b.$a),!b.$type&&b.$t&&(b.$type=b.$t);var e=b.$m||b.$model;return delete b.$m,delete b.$model,delete b.$n,delete b.$instanceof,delete b.$i,delete b.$a,delete b.$t,this._find(b,e)},b.prototype._find=function(a,b){if(!this.renderContext||!this.renderContext.$parentContext)return null;for(var c,d=b?function(a){return a&&a.$this instanceof wo.view?a.$this.model:null}:function(a){return a?a.$this:null},e=this.renderContext,f=a.$number;f>=0&&e;f--){var g=0;for(e=e.$parentContext;!wipeout.utils.find.is(c=d(e),a,g)&&e;)e=e.$parentContext,g++}return c},b.create=function(a){var b=new wipeout.utils.find(a);return function(a,c){return b.find(a,c)}},b.regex={ancestors:/^(great)*(grand){0,1}parent$/,great:/great/g,grand:/grand/g},b.$type=function(a,b,c){return a&&a.constructor===b},b.$ancestry=function(a,b,c){if(b=(b||"").toLowerCase(),-1!==b.indexOf("greatparent"))return!1;var d=0,e=b.match(wipeout.utils.find.regex.great);return e&&(d+=e.length),e=b.match(wipeout.utils.find.regex.grand),e&&(d+=e.length),d===c},b.$instanceOf=function(a,b,c){return a&&b&&b.constructor===Function?a instanceof b:!1},b.is=function(a,b,c){if(!a)return!1;for(var d in b)if("$number"!==d)if("$"===d[0]){if(!wipeout.utils.find[d](a,b[d],c))return!1}else if(b[d]!==a[d])return!1;return!0},b}),h("wipeout.utils.html",function(){function a(){}var b=function(a){return a?a.wipeoutOpening?a.wipeoutOpening.viewModel:a.wipeoutClosing?a.wipeoutClosing.viewModel:b(wipeout.template.rendering.renderedContent.getParentElement(a)):null},c=function(a){var b=document.createElement("span");return b.innerHTML="Loading template",b};return a.createTemplatePlaceholder=c,a.getViewModel=b,a}),h("wipeout.utils.jsParse",function(){function a(a,b,c){if(c)return!1;for(var d=0;"\\"===a[b-1-d];)d++;return d%2!=0}function b(a,b){a instanceof Function&&(a=a.toString());for(var c,d=[{end:0}],e=0;c=b.getFirst(a,e);)e=c.token.close.lastIndex,d.push(c);d.push({end:a.length});for(var c,g=[],h=new i,e=1,j=d.length;j>e;e++)g.push(a.substring(d[e-1].end,d[e].begin)),d[e].token&&d[e].token.tokenize&&(h[c=f()]=a.substring(d[e].begin,d[e].end),g.push(c));return h.output=g.join(""),h}function c(){}var d=[{open:/'/gm,close:/'/gm,tokenize:!0,isEscaped:a},{open:/"/gm,close:/"/gm,tokenize:!0,isEscaped:a},{open:/\/\//gm,close:/(?=\r?\n)/gm,tokenize:!1},{open:/\/\*/gm,close:/\*\//gm,tokenize:!1}],e=[{open:/\{/gm,close:/\}/gm,tokenize:!0,nested:!0},{open:/\(/gm,close:/\)/gm,tokenize:!0,nested:!0},{open:/\[/gm,close:/\]/gm,tokenize:!0,nested:!0}];e.getFirst=d.getFirst=function(a,b){for(var c,d,e,f=0,g=this.length;g>f;f++)this[f].open.lastIndex=b,c=this[f].open.exec(a),c&&(!d||c.index<d.index)&&(d=c,e=this[f]);if(d){var h,i,j=1;do{for(e.close.lastIndex=e.open.lastIndex;e.nested&&(h=e.open.exec(a))&&e.isEscaped&&e.isEscaped(a,h.index,!0););for(;(i=e.close.exec(a))&&e.isEscaped&&e.isEscaped(a,i.index,!1););if(!i)throw"Invalid function string: "+a;h&&h.index<i.index?j++:(e.open.lastIndex=e.close.lastIndex,j--)}while(e.nested&&j>0);return{token:e,begin:d.index,end:e.close.lastIndex}}};var f=function(){var a=0;return function(){return"##token"+ ++a+"##"}}(),g=function(a){return b(a,d)},h=function(a){var c=g(a),d=b(c.output,e);for(var f in d)d.hasOwnProperty(f)&&"output"!==f&&(d[f]=c.addTokens(d[f]));for(var f in c)"output"!==f&&(d[f]=c[f]);return d},i=function(){};return i.prototype.addTokens=function(a){for(var b in this)this.hasOwnProperty(b)&&"output"!==b&&(a=a.replace(b,this[b]));return a},c.removeCommentsTokenStrings=g,c.removeCommentsTokenStringsAndBrackets=h,c}),h("wipeout.utils.viewModels",function(){function a(){}var b="data-wo-element-name";return a.getElementName=function(a){var c;if(a.getAttribute&&null!=(c=a.getAttribute(b)))return c;var d=n(l(a instanceof Element?a.localName:a.name));return/^js[A-Z]/.test(d)?d.substr(2):d},a.getViewModelConstructor=function(b){var c,d=a.getElementName(b);return(c=wipeout.utils.obj.getObject(d))?{name:d,constructor:c}:void 0},a}),h("wipeout.viewModels.contentControl",function(){function a(a,b,c){this.currentTemplate=a[c],this.currentTemplateId=a[b],this.owner=a,this.templateIdProperty=b,this.templateProperty=c,this.refreshTemplate(this.currentTemplateId),this.d1=a.observe(b,this.onTemplateIdChange,this),this.d2=a.observe(c,this.onTemplateChange,this)}var b=wipeout.viewModels.view.extend(function(a,b){this._super(a,b),wipeout.viewModels.contentControl.createTemplatePropertyFor(this,"templateId","setTemplate")});return b.addGlobalParser("setTemplate","template"),b.addGlobalBindingType("setTemplate","setTemplateToTemplateId"),b.createTemplatePropertyFor=function(b,c,d){return new a(b,c,d)},b.createAnonymousTemplate=function(){function a(){return c+"-"+ ++b}var b=Math.floor(1e9*Math.random()),c="WipeoutAnonymousTemplate",d={};return function(b){if("string"==typeof b){if(!d[b]){var e=a();wipeout.template.engine.instance.setTemplate(e,b),d[b]=e}return d[b]}if(!b[c]){var e=a();wipeout.template.engine.instance.setTemplate(e,b),b[c]=e}return b[c]}}(),a.prototype.dispose=function(){this.d1.dispose(),this.d2.dispose()},a.prototype.refreshTemplate=function(a){this.pendingLoad=wipeout.template.engine.instance.getTemplateXml(a,function(a){delete this.pendingLoad,this.currentTemplate=this.owner[this.templateProperty]=a}.bind(this))},a.prototype.onTemplateIdChange=function(a,b){return b===this.currentTemplateId?void(this.currentTemplateId=null):(this.currentTemplateId=null,this.pendingLoad&&this.pendingLoad.cancel(),void this.refreshTemplate(b))},a.prototype.onTemplateChange=function(a,b){return b===this.currentTemplate?void(this.currentTemplate=null):(this.currentTemplate=null,void(this.currentTemplateId=this.owner[this.templateIdProperty]=wipeout.viewModels.contentControl.createAnonymousTemplate(b)))},b}),h("wipeout.viewModels.if",function(){var a=!0,b=function(){a&&(a=!1,c.blankTemplateId=wipeout.viewModels.contentControl.createAnonymousTemplate("",!0))},c=wipeout.viewModels.contentControl.extend(function d(a,c){b(),this._super(a,c),this.shareParentScope=!0,this.condition=!1,this.elseTemplateId=d.blankTemplateId,this.observe("elseTemplateId",this.elseTemplateChanged,this),this.elseTemplate="",wipeout.viewModels.contentControl.createTemplatePropertyFor(this,"elseTemplateId","elseTemplate"),this.__cachedTemplateId=this.templateId,this.observe("condition",this.onConditionChanged,this),this.observe("templateId",this.copyTemplateId,this),this.copyTemplateId(null,this.templateId)});return c.addGlobalParser("elseTemplate","template"),c.addGlobalBindingType("elseTemplate","templateProperty"),c.prototype.elseTemplateChanged=function(a,b){this.condition||this.synchronusTemplateChange(b)},c.prototype.onConditionChanged=function(a,b){this.__oldConditionVal&&!b?this.synchronusTemplateChange(this.elseTemplateId):!this.__oldConditionVal&&b&&this.synchronusTemplateChange(this.__cachedTemplateId),this.__oldConditionVal=!!b},c.prototype.copyTemplateId=function(a,b){b!==this.elseTemplateId&&(this.__cachedTemplateId=b),this.condition||b===this.elseTemplateId||(this.templateId=this.elseTemplateId)},c}),h("wipeout.viewModels.itemsControl",function(){var a,c,d=wipeout.viewModels.contentControl.extend(function e(c,d,g){this._super(c||a||(a=wipeout.viewModels.contentControl.createAnonymousTemplate("{{$this.items}}")),g),this.itemTemplateId=d,this.itemTemplate="",wipeout.viewModels.contentControl.createTemplatePropertyFor(this,"itemTemplateId","itemTemplate"),this.items=new b.array,this.registerDisposable(this.items),this.registerRoutedEvent(e.removeItem,this._removeItem,this),this.observe("itemTemplateId",function(a,b){f(this.getItemViewModels(),function(a){a.__createdByItemsControl&&(a.templateId=b)})},this)});return d.addGlobalParser("itemTemplate","template"),d.addGlobalBindingType("itemTemplate","templateProperty"),d.removeItem=wipeout.events.routedEvent(),d.prototype._removeItem=function(a){-1!==this.items.indexOf(a.data)&&(this.removeItem(a.data),a.handled=!0)},d.prototype.getItemViewModels=function(){return this.$getChild?this.$getChild():[]},d.prototype.getItemViewModel=function(a){return this.$getChild?this.$getChild(a):void 0},d.prototype.removeItem=function(a){this.items.remove(a)},d.prototype.onItemRendered=function(a){},d.prototype.onItemRemoved=function(a){a.dispose()},d.prototype._createItem=function(a){var b=this.createItem(a);return b},d.prototype.createItem=function(a){var b=new wipeout.viewModels.view(this.itemTemplateId||c||(c=wipeout.viewModels.contentControl.createAnonymousTemplate("{{$this.model}}")),a);return b.__createdByItemsControl=!0,b},d}),function(){var a=wipeout.viewModels.view;a.prototype.unRegisterRoutedEvent=function(a,b,c){for(var d=0,e=this.$routedEventSubscriptions.length;e>d;d++)if(this.$routedEventSubscriptions[d].routedEvent===a)return this.$routedEventSubscriptions[d].event.unRegister(b,c),!0;return!1},a.prototype.registerRoutedEvent=function(a,b,c,d){for(var e,f=0,g=this.$routedEventSubscriptions.length;g>f;f++)if(this.$routedEventSubscriptions[f].routedEvent===a){e=this.$routedEventSubscriptions[f];break}return e||(e=new wipeout.events.routedEventRegistration(a),this.$routedEventSubscriptions.push(e)),e.event.register(b,c,d)},a.prototype.triggerRoutedEvent=function(a,b){b instanceof wipeout.events.routedEventArgs||(b=new wipeout.events.routedEventArgs(b,this));for(var c=0,d=this.$routedEventSubscriptions.length;d>c;c++){if(b.handled)return;this.$routedEventSubscriptions[c].routedEvent===a&&this.$routedEventSubscriptions[c].event.trigger(b)}if(!b.handled&&(this.model instanceof wipeout.events.routedEventModel&&this.model.routedEventTriggered(a,b),!b.handled)){var e=this.getParent();e&&e.triggerRoutedEvent(a,b)}}}();var p=function(){if(this._parentElement){for(var a in this._parentElement)if(this._parentElement[a]===this)return this._parentElement;delete this._parentElement}return null};h("wipeout.wml.wmlElementBase",function(){var b=a.extend(function(){this._super(),this.length=0});return b.extend=a.extend,b.prototype._super=a.prototype._super,b.prototype.push=function(a){if(a.getParentElement!==p)throw"Invalid template node";if(a.getParentElement())throw"This node already has a parent element";return this[this.length]=a,this.length++,a._parentElement=this,this.length},b.prototype.splice=function(){throw"not implemented"},b.prototype.serializeContent=function(){var a=[];return wipeout.utils.obj.enumerateArr(this,function(b){a.push(b.serialize())}),a.join("")},b}),h("wipeout.wml.wmlElement",function(){var a=wipeout.wml.wmlElementBase.extend(function(a,b){this._super(),this.name=a,this.attributes={},this.inline=!!b,this.nodeType=1});return a.prototype.getParentElement=p,a.prototype.getAttribute=function(a){return this.attributes[a]?this.attributes[a].value:null},a.prototype.serialize=function(){var a=[];a.splice(0,0,"<",this.name);var b=2;for(var c in this.attributes)a.splice(b,0," ",c,this.attributes[c].serializeValue()),b+=3;var d=this.serializeContent();return!d.length&&this.inline?a.push(" />"):(a.push(">"),a.push(d),a.push("</"+this.name+">")),a.join("")},a}),h("wipeout.wml.wmlAttribute",function(){function a(a){this.value=a,this.nodeType=2}return a.prototype.serializeValue=function(){return'="'+this.value.replace(/&/g,"&amp;").replace(/"/g,"&quot;")+'"'},a.prototype.serializeContent=function(){return this.value},a}),h("wipeout.wml.wmlComment",function(){var a=function(a){this.commentText=a,this.nodeType=8};return a.prototype.serialize=function(){return"<!--"+this.commentText+"-->"},a.prototype.getParentElement=p,a}),h("wipeout.wml.wmlString",function(){var a=function(a){this.text=a,this.nodeType=3};return a.prototype.serialize=function(){return this.text},a.prototype.getParentElement=p,a}),h("wipeout.wml.wmlParser",function(){function a(b){for(var c,d=new wipeout.wml.wmlElement(b.localName,-1!==e.indexOf(b.localName)),f=0,g=b.childNodes.length;g>f;f++)1===b.childNodes[f].nodeType?d.push(a(b.childNodes[f])):8===b.childNodes[f].nodeType?d.push(new wipeout.wml.wmlComment(b.childNodes[f].textContent)):3===b.childNodes[f].nodeType?d.push(new wipeout.wml.wmlString(b.childNodes[f].textContent)):(c=document.createElement("div"),c.appendChild(b.childNodes[f]),d.push(new wipeout.wml.wmlString(c.innerHTML)));for(var f=0,g=b.attributes.length;g>f;f++)d.attributes[b.attributes[f].name]=new wipeout.wml.wmlAttribute(b.attributes[f].value);return d}function b(c){if(c instanceof Element)return a(c);var d=b.addToElement(c);if(!d)throw"Cannot create a template for the following string: "+c;return a(d)}b.specialTags={area:"map",base:"head",basefont:"head",body:"html",caption:"table",col:"colgroup",colgroup:"table",command:"menu",frame:"frameset",frameset:"html",head:"html",keygen:"form",li:"ul",optgroup:"select",option:"select",rp:"rt",rt:"ruby",source:"audio",tbody:"table",td:"tr",tfoot:"table",th:"tr",thead:"table",tr:"tbody"},b.cannotCreateTags={html:!0,basefont:!0,base:!0,body:!0,frame:!0,frameset:!0,head:!0},b.ieReadonlyElements={audio:!0,col:!0,colgroup:!0,frameset:!0,head:!0,rp:!0,rt:!0,ruby:!0,select:!0,style:!0,table:!0,tbody:!0,tfooy:!0,thead:!0,title:!0,tr:!0},b.getFirstTagName=function(a){var b=/^\s*<\s*[a-z\-\.0-9\$]+(\s|>|\/)/.exec(a.replace(/<\!--[^>]*-->/g,"").replace(/^\s*/,""));return b?k(b[0].substr(1,b[0].length-2)):null};var c=document.createElement("table");c.innerHTML="<tbody></tbody>";var d=!c.childNodes.length;b.addToElement=function(a){var c=b.getFirstTagName(a);if(!c){var e=document.createElement("div");return e.innerHTML=a,e}if(b.cannotCreateTags[c])throw'Cannot create an instance of the "'+c+'" tag.';var f=b.specialTags[c]||"div";if(d&&b.ieReadonlyElements[f]){for(var g=b.createElement("<"+f+">"+a+"</"+f+">"),h=0,i=g.childNodes.length;i>h;h++){var j=g.childNodes[h];if(1===j.nodeType&&l(j.tagName)===f)return j}return document.createElement(f)}var e=document.createElement(f);return e.innerHTML=a,e};var e=["area","base","br","col","command","hr","img","input","keygen","link","meta","param","source"];return b}),window.wo=function(a,c){var d=new b.disposable;if(arguments.length<2?c=document.getElementsByTagName("body")[0]:"string"==typeof c&&(c=document.getElementById(c)),wipeout.utils.viewModels.getViewModelConstructor(c)){var e=new wipeout.template.rendering.viewModelElement(c);

null!=a&&(e.createdViewModel.model=a),d.registerDisposable(e)}else f(wipeout.utils.obj.copyArray(c.getElementsByTagName("*")),function(b){if(c.contains(b)&&wipeout.utils.viewModels.getViewModelConstructor(b)){var e=new wipeout.template.rendering.viewModelElement(b);null!=a&&(e.createdViewModel.model=a),d.registerDisposable(e)}});return d},window.addEventListener("load",function(){window.wo()}),d("viewModel",c),d("routedEvent",wipeout.events.routedEvent),d("array",b.array),d("observable",b.observable),d("bindings",wipeout.htmlBindingTypes),d("parsers",wipeout.template.initialization.parsers),d("filters",wipeout.template.filters),d("addHtmlAttribute",i),g(wipeout.viewModels,function(a,b){d(b,a)})}(window.orienteer,window.busybody);

}());